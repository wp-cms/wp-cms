(function($,undefined){var storage=[];acs.Field=acs.Model.extend({type:"",eventScope:".acs-field",wait:"ready",setup:function($field){this.$el=$field;this.inherit($field);this.inherit(this.$control())},val:function(val){if(val!==undefined){return this.setValue(val)}else{return this.prop("disabled")?null:this.getValue()}},getValue:function(){return this.$input().val()},setValue:function(val){return acs.val(this.$input(),val)},__:function(string){return acs._e(this.type,string)},$control:function(){return false},$input:function(){return this.$("[name]:first")},$inputWrap:function(){return this.$(".acs-input:first")},$labelWrap:function(){return this.$(".acs-label:first")},getInputName:function(){return this.$input().attr("name")||""},parent:function(){var parents=this.parents();return parents.length?parents[0]:false},parents:function(){var $parents=this.$el.parents(".acs-field");var parents=acs.getFields($parents);return parents},show:function(lockKey,context){var changed=acs.show(this.$el,lockKey);if(changed){this.prop("hidden",false);acs.doAction("show_field",this,context)}return changed},hide:function(lockKey,context){var changed=acs.hide(this.$el,lockKey);if(changed){this.prop("hidden",true);acs.doAction("hide_field",this,context)}return changed},enable:function(lockKey,context){var changed=acs.enable(this.$el,lockKey);if(changed){this.prop("disabled",false);acs.doAction("enable_field",this,context)}return changed},disable:function(lockKey,context){var changed=acs.disable(this.$el,lockKey);if(changed){this.prop("disabled",true);acs.doAction("disable_field",this,context)}return changed},showEnable:function(lockKey,context){this.enable.apply(this,arguments);return this.show.apply(this,arguments)},hideDisable:function(lockKey,context){this.disable.apply(this,arguments);return this.hide.apply(this,arguments)},showNotice:function(props){if(typeof props!=="object"){props={text:props}}if(this.notice){this.notice.remove()}props.target=this.$inputWrap();this.notice=acs.newNotice(props)},removeNotice:function(timeout){if(this.notice){this.notice.away(timeout||0);this.notice=false}},showError:function(message){this.$el.addClass("acs-error");if(message!==undefined){this.showNotice({text:message,type:"error",dismiss:false})}acs.doAction("invalid_field",this);this.$el.one("focus change","input, select, textarea",$.proxy(this.removeError,this))},removeError:function(){this.$el.removeClass("acs-error");this.removeNotice(250);acs.doAction("valid_field",this)},trigger:function(name,args,bubbles){if(name=="invalidField"){bubbles=true}return acs.Model.prototype.trigger.apply(this,[name,args,bubbles])}});acs.newField=function($field){var type=$field.data("type");var mid=modelId(type);var model=acs.models[mid]||acs.Field;var field=new model($field);acs.doAction("new_field",field);return field};var modelId=function(type){return acs.strPascalCase(type||"")+"Field"};acs.registerFieldType=function(model){var proto=model.prototype;var type=proto.type;var mid=modelId(type);acs.models[mid]=model;storage.push(type)};acs.getFieldType=function(type){var mid=modelId(type);return acs.models[mid]||false};acs.getFieldTypes=function(args){args=acs.parseArgs(args,{category:""});var types=[];storage.map(function(type){var model=acs.getFieldType(type);var proto=model.prototype;if(args.category&&proto.category!==args.category){return}types.push(model)});return types}})(jQuery);(function($,undefined){acs.findFields=function(args){var selector=".acs-field";var $fields=false;args=acs.parseArgs(args,{key:"",name:"",type:"",is:"",parent:false,sibling:false,limit:false,visible:false,suppressFilters:false});if(!args.suppressFilters){args=acs.applyFilters("find_fields_args",args)}if(args.key){selector+='[data-key="'+args.key+'"]'}if(args.type){selector+='[data-type="'+args.type+'"]'}if(args.name){selector+='[data-name="'+args.name+'"]'}if(args.is){selector+=args.is}if(args.visible){selector+=":visible"}if(args.parent){$fields=args.parent.find(selector)}else if(args.sibling){$fields=args.sibling.siblings(selector)}else{$fields=$(selector)}if(!args.suppressFilters){$fields=$fields.not(".acs-clone .acs-field");$fields=acs.applyFilters("find_fields",$fields)}if(args.limit){$fields=$fields.slice(0,args.limit)}return $fields};acs.findField=function(key,$parent){return acs.findFields({key:key,limit:1,parent:$parent,suppressFilters:true})};acs.getField=function($field){if($field instanceof jQuery){}else{$field=acs.findField($field)}var field=$field.data("acs");if(!field){field=acs.newField($field)}return field};acs.getFields=function($fields){if($fields instanceof jQuery){}else{$fields=acs.findFields($fields)}var fields=[];$fields.each(function(){var field=acs.getField($(this));fields.push(field)});return fields};acs.findClosestField=function($el){return $el.closest(".acs-field")};acs.getClosestField=function($el){var $field=acs.findClosestField($el);return this.getField($field)};var addGlobalFieldAction=function(action){var globalAction=action;var pluralAction=action+"_fields";var singleAction=action+"_field";var globalCallback=function($el){var args=acs.arrayArgs(arguments);var extraArgs=args.slice(1);var fields=acs.getFields({parent:$el});if(fields.length){var pluralArgs=[pluralAction,fields].concat(extraArgs);acs.doAction.apply(null,pluralArgs)}};var pluralCallback=function(fields){var args=acs.arrayArgs(arguments);var extraArgs=args.slice(1);fields.map(function(field,i){var singleArgs=[singleAction,field].concat(extraArgs);acs.doAction.apply(null,singleArgs)})};acs.addAction(globalAction,globalCallback);acs.addAction(pluralAction,pluralCallback);addSingleFieldAction(action)};var addSingleFieldAction=function(action){var singleAction=action+"_field";var singleEvent=action+"Field";var singleCallback=function(field){var args=acs.arrayArgs(arguments);var extraArgs=args.slice(1);var variations=["type","name","key"];variations.map(function(variation){var prefix="/"+variation+"="+field.get(variation);args=[singleAction+prefix,field].concat(extraArgs);acs.doAction.apply(null,args)});if(singleFieldEvents.indexOf(action)>-1){field.trigger(singleEvent,extraArgs)}};acs.addAction(singleAction,singleCallback)};var globalFieldActions=["prepare","ready","load","append","remove","unmount","remount","sortstart","sortstop","show","hide","unload"];var singleFieldActions=["valid","invalid","enable","disable","new","duplicate"];var singleFieldEvents=["remove","unmount","remount","sortstart","sortstop","show","hide","unload","valid","invalid","enable","disable","duplicate"];globalFieldActions.map(addGlobalFieldAction);singleFieldActions.map(addSingleFieldAction);var fieldsEventManager=new acs.Model({id:"fieldsEventManager",events:{'click .acs-field a[href="#"]':"onClick","change .acs-field":"onChange"},onClick:function(e){e.preventDefault()},onChange:function(){$("#_acs_changed").val(1)}});var duplicateFieldsManager=new acs.Model({id:"duplicateFieldsManager",actions:{duplicate:"onDuplicate",duplicate_fields:"onDuplicateFields"},onDuplicate:function($el,$el2){var fields=acs.getFields({parent:$el});if(fields.length){var $fields=acs.findFields({parent:$el2});acs.doAction("duplicate_fields",fields,$fields)}},onDuplicateFields:function(fields,duplicates){fields.map(function(field,i){acs.doAction("duplicate_field",field,$(duplicates[i]))})}})})(jQuery);(function($,undefined){var i=0;var Field=acs.Field.extend({type:"accordion",wait:"",$control:function(){return this.$(".acs-fields:first")},initialize:function(){if(this.$el.hasClass("acs-accordion")){return}if(this.$el.is("td"))return;if(this.get("endpoint")){return this.remove()}var $field=this.$el;var $label=this.$labelWrap();var $input=this.$inputWrap();var $wrap=this.$control();var $instructions=$input.children(".description");if($instructions.length){$label.append($instructions)}if(this.$el.is("tr")){var $table=this.$el.closest("table");var $newLabel=$('<div class="acs-accordion-title"/>');var $newInput=$('<div class="acs-accordion-content"/>');var $newTable=$('<table class="'+$table.attr("class")+'"/>');var $newWrap=$("<tbody/>");$newLabel.append($label.html());$newTable.append($newWrap);$newInput.append($newTable);$input.append($newLabel);$input.append($newInput);$label.remove();$wrap.remove();$input.attr("colspan",2);$label=$newLabel;$input=$newInput;$wrap=$newWrap}$field.addClass("acs-accordion");$label.addClass("acs-accordion-title");$input.addClass("acs-accordion-content");i++;if(this.get("multi_expand")){$field.attr("multi-expand",1)}var order=acs.getPreference("this.accordions")||[];if(order[i-1]!==undefined){this.set("open",order[i-1])}if(this.get("open")){$field.addClass("-open");$input.css("display","block")}$label.prepend(accordionManager.iconHtml({open:this.get("open")}));var $parent=$field.parent();$wrap.addClass($parent.hasClass("-left")?"-left":"");$wrap.addClass($parent.hasClass("-clear")?"-clear":"");$wrap.append($field.nextUntil(".acs-field-accordion",".acs-field"));$wrap.removeAttr("data-open data-multi_expand data-endpoint")}});acs.registerFieldType(Field);var accordionManager=new acs.Model({actions:{unload:"onUnload"},events:{"click .acs-accordion-title":"onClick","invalidField .acs-accordion":"onInvalidField"},isOpen:function($el){return $el.hasClass("-open")},toggle:function($el){if(this.isOpen($el)){this.close($el)}else{this.open($el)}},iconHtml:function(props){if(acs.isGutenberg()){if(props.open){return'<svg class="acs-accordion-icon" width="24px" height="24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" focusable="false"><g><path fill="none" d="M0,0h24v24H0V0z"></path></g><g><path d="M12,8l-6,6l1.41,1.41L12,10.83l4.59,4.58L18,14L12,8z"></path></g></svg>'}else{return'<svg class="acs-accordion-icon" width="24px" height="24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" focusable="false"><g><path fill="none" d="M0,0h24v24H0V0z"></path></g><g><path d="M7.41,8.59L12,13.17l4.59-4.58L18,10l-6,6l-6-6L7.41,8.59z"></path></g></svg>'}}else{if(props.open){return'<i class="acs-accordion-icon dashicons dashicons-arrow-down"></i>'}else{return'<i class="acs-accordion-icon dashicons dashicons-arrow-right"></i>'}}},open:function($el){var duration=acs.isGutenberg()?0:300;$el.find(".acs-accordion-content:first").slideDown(duration).css("display","block");$el.find(".acs-accordion-icon:first").replaceWith(this.iconHtml({open:true}));$el.addClass("-open");acs.doAction("show",$el);if(!$el.attr("multi-expand")){$el.siblings(".acs-accordion.-open").each(function(){accordionManager.close($(this))})}},close:function($el){var duration=acs.isGutenberg()?0:300;$el.find(".acs-accordion-content:first").slideUp(duration);$el.find(".acs-accordion-icon:first").replaceWith(this.iconHtml({open:false}));$el.removeClass("-open");acs.doAction("hide",$el)},onClick:function(e,$el){e.preventDefault();this.toggle($el.parent())},onInvalidField:function(e,$el){if(this.busy){return}this.busy=true;this.setTimeout(function(){this.busy=false},1e3);this.open($el)},onUnload:function(e){var order=[];$(".acs-accordion").each(function(){var open=$(this).hasClass("-open")?1:0;order.push(open)});if(order.length){acs.setPreference("this.accordions",order)}}})})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"button_group",events:{'click input[type="radio"]':"onClick"},$control:function(){return this.$(".acs-button-group")},$input:function(){return this.$("input:checked")},setValue:function(val){this.$('input[value="'+val+'"]').prop("checked",true).trigger("change")},onClick:function(e,$el){var $label=$el.parent("label");var selected=$label.hasClass("selected");this.$(".selected").removeClass("selected");$label.addClass("selected");if(this.get("allow_null")&&selected){$label.removeClass("selected");$el.prop("checked",false).trigger("change")}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"checkbox",events:{"change input":"onChange","click .acs-add-checkbox":"onClickAdd","click .acs-checkbox-toggle":"onClickToggle","click .acs-checkbox-custom":"onClickCustom"},$control:function(){return this.$(".acs-checkbox-list")},$toggle:function(){return this.$(".acs-checkbox-toggle")},$input:function(){return this.$('input[type="hidden"]')},$inputs:function(){return this.$('input[type="checkbox"]').not(".acs-checkbox-toggle")},getValue:function(){var val=[];this.$(":checked").each(function(){val.push($(this).val())});return val.length?val:false},onChange:function(e,$el){var checked=$el.prop("checked");var $label=$el.parent("label");var $toggle=this.$toggle();if(checked){$label.addClass("selected")}else{$label.removeClass("selected")}if($toggle.length){var $inputs=this.$inputs();if($inputs.not(":checked").length==0){$toggle.prop("checked",true)}else{$toggle.prop("checked",false)}}},onClickAdd:function(e,$el){var html='<li><input class="acs-checkbox-custom" type="checkbox" checked="checked" /><input type="text" name="'+this.getInputName()+'[]" /></li>';$el.parent("li").before(html)},onClickToggle:function(e,$el){var checked=$el.prop("checked");var $inputs=this.$('input[type="checkbox"]');var $labels=this.$("label");$inputs.prop("checked",checked);if(checked){$labels.addClass("selected")}else{$labels.removeClass("selected")}},onClickCustom:function(e,$el){var checked=$el.prop("checked");var $text=$el.next('input[type="text"]');if(checked){$text.prop("disabled",false)}else{$text.prop("disabled",true);if($text.val()==""){$el.parent("li").remove()}}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"color_picker",wait:"load",events:{duplicateField:"onDuplicate"},$control:function(){return this.$(".acs-color-picker")},$input:function(){return this.$('input[type="hidden"]')},$inputText:function(){return this.$('input[type="text"]')},setValue:function(val){acs.val(this.$input(),val);this.$inputText().iris("color",val)},initialize:function(){var $input=this.$input();var $inputText=this.$inputText();var onChange=function(e){setTimeout(function(){acs.val($input,$inputText.val())},1)};var args={defaultColor:false,palettes:true,hide:true,change:onChange,clear:onChange};var args=acs.applyFilters("color_picker_args",args,this);$inputText.wpColorPicker(args)},onDuplicate:function(e,$el,$duplicate){$colorPicker=$duplicate.find(".wp-picker-container");$inputText=$duplicate.find('input[type="text"]');$colorPicker.replaceWith($inputText)}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"date_picker",events:{'blur input[type="text"]':"onBlur",duplicateField:"onDuplicate"},$control:function(){return this.$(".acs-date-picker")},$input:function(){return this.$('input[type="hidden"]')},$inputText:function(){return this.$('input[type="text"]')},initialize:function(){if(this.has("save_format")){return this.initializeCompatibility()}var $input=this.$input();var $inputText=this.$inputText();var args={dateFormat:this.get("date_format"),altField:$input,altFormat:"yymmdd",changeYear:true,yearRange:"-100:+100",changeMonth:true,showButtonPanel:true,firstDay:this.get("first_day")};args=acs.applyFilters("date_picker_args",args,this);acs.newDatePicker($inputText,args);acs.doAction("date_picker_init",$inputText,args,this)},initializeCompatibility:function(){var $input=this.$input();var $inputText=this.$inputText();$inputText.val($input.val());var args={dateFormat:this.get("date_format"),altField:$input,altFormat:this.get("save_format"),changeYear:true,yearRange:"-100:+100",changeMonth:true,showButtonPanel:true,firstDay:this.get("first_day")};args=acs.applyFilters("date_picker_args",args,this);var dateFormat=args.dateFormat;args.dateFormat=this.get("save_format");acs.newDatePicker($inputText,args);$inputText.datepicker("option","dateFormat",dateFormat);acs.doAction("date_picker_init",$inputText,args,this)},onBlur:function(){if(!this.$inputText().val()){acs.val(this.$input(),"")}},onDuplicate:function(e,$el,$duplicate){$duplicate.find('input[type="text"]').removeClass("hasDatepicker").removeAttr("id")}});acs.registerFieldType(Field);var datePickerManager=new acs.Model({priority:5,wait:"ready",initialize:function(){var locale=acs.get("locale");var rtl=acs.get("rtl");var l10n=acs.get("datePickerL10n");if(!l10n){return false}if(typeof $.datepicker==="undefined"){return false}l10n.isRTL=rtl;$.datepicker.regional[locale]=l10n;$.datepicker.setDefaults(l10n)}});acs.newDatePicker=function($input,args){if(typeof $.datepicker==="undefined"){return false}args=args||{};$input.datepicker(args);if($("body > #ui-datepicker-div").exists()){$("body > #ui-datepicker-div").wrap('<div class="acs-ui-datepicker" />')}}})(jQuery);(function($,undefined){var Field=acs.models.DatePickerField.extend({type:"date_time_picker",$control:function(){return this.$(".acs-date-time-picker")},initialize:function(){var $input=this.$input();var $inputText=this.$inputText();var args={dateFormat:this.get("date_format"),timeFormat:this.get("time_format"),altField:$input,altFieldTimeOnly:false,altFormat:"yy-mm-dd",altTimeFormat:"HH:mm:ss",changeYear:true,yearRange:"-100:+100",changeMonth:true,showButtonPanel:true,firstDay:this.get("first_day"),controlType:"select",oneLine:true};args=acs.applyFilters("date_time_picker_args",args,this);acs.newDateTimePicker($inputText,args);acs.doAction("date_time_picker_init",$inputText,args,this)}});acs.registerFieldType(Field);var dateTimePickerManager=new acs.Model({priority:5,wait:"ready",initialize:function(){var locale=acs.get("locale");var rtl=acs.get("rtl");var l10n=acs.get("dateTimePickerL10n");if(!l10n){return false}if(typeof $.timepicker==="undefined"){return false}l10n.isRTL=rtl;$.timepicker.regional[locale]=l10n;$.timepicker.setDefaults(l10n)}});acs.newDateTimePicker=function($input,args){if(typeof $.timepicker==="undefined"){return false}args=args||{};$input.datetimepicker(args);if($("body > #ui-datepicker-div").exists()){$("body > #ui-datepicker-div").wrap('<div class="acs-ui-datepicker" />')}}})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"google_map",map:false,wait:"load",events:{'click a[data-name="clear"]':"onClickClear",'click a[data-name="locate"]':"onClickLocate",'click a[data-name="search"]':"onClickSearch","keydown .search":"onKeydownSearch","keyup .search":"onKeyupSearch","focus .search":"onFocusSearch","blur .search":"onBlurSearch",showField:"onShow"},$control:function(){return this.$(".acs-google-map")},$search:function(){return this.$(".search")},$canvas:function(){return this.$(".canvas")},setState:function(state){this.$control().removeClass("-value -loading -searching");if(state==="default"){state=this.val()?"value":""}if(state){this.$control().addClass("-"+state)}},getValue:function(){var val=this.$input().val();if(val){return JSON.parse(val)}else{return false}},setValue:function(val,silent){var valAttr="";if(val){valAttr=JSON.stringify(val)}acs.val(this.$input(),valAttr);if(silent){return}this.renderVal(val);acs.doAction("google_map_change",val,this.map,this)},renderVal:function(val){if(val){this.setState("value");this.$search().val(val.address);this.setPosition(val.lat,val.lng)}else{this.setState("");this.$search().val("");this.map.marker.setVisible(false)}},newLatLng:function(lat,lng){return new google.maps.LatLng(parseFloat(lat),parseFloat(lng))},setPosition:function(lat,lng){this.map.marker.setPosition({lat:parseFloat(lat),lng:parseFloat(lng)});this.map.marker.setVisible(true);this.center()},center:function(){var position=this.map.marker.getPosition();if(position){var lat=position.lat();var lng=position.lng()}else{var lat=this.get("lat");var lng=this.get("lng")}this.map.setCenter({lat:parseFloat(lat),lng:parseFloat(lng)})},initialize:function(){withAPI(this.initializeMap.bind(this))},initializeMap:function(){var val=this.getValue();var args=acs.parseArgs(val,{zoom:this.get("zoom"),lat:this.get("lat"),lng:this.get("lng")});var mapArgs={scrollwheel:false,zoom:parseInt(args.zoom),center:{lat:parseFloat(args.lat),lng:parseFloat(args.lng)},mapTypeId:google.maps.MapTypeId.ROADMAP,marker:{draggable:true,raiseOnDrag:true},autocomplete:{}};mapArgs=acs.applyFilters("google_map_args",mapArgs,this);var map=new google.maps.Map(this.$canvas()[0],mapArgs);var markerArgs=acs.parseArgs(mapArgs.marker,{draggable:true,raiseOnDrag:true,map:map});markerArgs=acs.applyFilters("google_map_marker_args",markerArgs,this);var marker=new google.maps.Marker(markerArgs);var autocomplete=false;if(acs.isset(google,"maps","places","Autocomplete")){var autocompleteArgs=mapArgs.autocomplete||{};autocompleteArgs=acs.applyFilters("google_map_autocomplete_args",autocompleteArgs,this);autocomplete=new google.maps.places.Autocomplete(this.$search()[0],autocompleteArgs);autocomplete.bindTo("bounds",map)}this.addMapEvents(this,map,marker,autocomplete);map.acs=this;map.marker=marker;map.autocomplete=autocomplete;this.map=map;if(val){this.setPosition(val.lat,val.lng)}acs.doAction("google_map_init",map,marker,this)},addMapEvents:function(field,map,marker,autocomplete){google.maps.event.addListener(map,"click",function(e){var lat=e.latLng.lat();var lng=e.latLng.lng();field.searchPosition(lat,lng)});google.maps.event.addListener(marker,"dragend",function(){var lat=this.getPosition().lat();var lng=this.getPosition().lng();field.searchPosition(lat,lng)});if(autocomplete){google.maps.event.addListener(autocomplete,"place_changed",function(){var place=this.getPlace();field.searchPlace(place)})}google.maps.event.addListener(map,"zoom_changed",function(){var val=field.val();if(val){val.zoom=map.getZoom();field.setValue(val,true)}})},searchPosition:function(lat,lng){this.setState("loading");var latLng={lat:lat,lng:lng};geocoder.geocode({location:latLng},function(results,status){this.setState("");if(status!=="OK"){this.showNotice({text:acs.__("Location not found: %s").replace("%s",status),type:"warning"})}else{var val=this.parseResult(results[0]);val.lat=lat;val.lng=lng;this.val(val)}}.bind(this))},searchPlace:function(place){if(!place){return}if(place.geometry){place.formatted_address=this.$search().val();var val=this.parseResult(place);this.val(val)}else if(place.name){this.searchAddress(place.name)}},searchAddress:function(address){if(!address){return}var latLng=address.split(",");if(latLng.length==2){var lat=parseFloat(latLng[0]);var lng=parseFloat(latLng[1]);if(lat&&lng){return this.searchPosition(lat,lng)}}this.setState("loading");geocoder.geocode({address:address},function(results,status){this.setState("");if(status!=="OK"){this.showNotice({text:acs.__("Location not found: %s").replace("%s",status),type:"warning"})}else{var val=this.parseResult(results[0]);val.address=address;this.val(val)}}.bind(this))},searchLocation:function(){if(!navigator.geolocation){return alert(acs.__("Sorry, this browser does not support geolocation"))}this.setState("loading");navigator.geolocation.getCurrentPosition(function(results){this.setState("");var lat=results.coords.latitude;var lng=results.coords.longitude;this.searchPosition(lat,lng)}.bind(this),function(error){this.setState("")}.bind(this))},parseResult:function(obj){var result={address:obj.formatted_address,lat:obj.geometry.location.lat(),lng:obj.geometry.location.lng()};result.zoom=this.map.getZoom();if(obj.place_id){result.place_id=obj.place_id}if(obj.name){result.name=obj.name}var map={street_number:["street_number"],street_name:["street_address","route"],city:["locality"],state:["administrative_area_level_1","administrative_area_level_2","administrative_area_level_3","administrative_area_level_4","administrative_area_level_5"],post_code:["postal_code"],country:["country"]};for(var k in map){var keywords=map[k];for(var i=0;i<obj.address_components.length;i++){var component=obj.address_components[i];var component_type=component.types[0];if(keywords.indexOf(component_type)!==-1){result[k]=component.long_name;if(component.long_name!==component.short_name){result[k+"_short"]=component.short_name}}}}return acs.applyFilters("google_map_result",result,obj,this.map,this)},onClickClear:function(){this.val(false)},onClickLocate:function(){this.searchLocation()},onClickSearch:function(){this.searchAddress(this.$search().val())},onFocusSearch:function(e,$el){this.setState("searching")},onBlurSearch:function(e,$el){var val=this.val();var address=val?val.address:"";if($el.val()===address){this.setState("default")}},onKeyupSearch:function(e,$el){if(!$el.val()){this.val(false)}},onKeydownSearch:function(e,$el){if(e.which==13){e.preventDefault();$el.blur()}},onShow:function(){if(this.map){this.setTimeout(this.center)}}});acs.registerFieldType(Field);var loading=false;var geocoder=false;function withAPI(callback){if(geocoder){return callback()}if(acs.isset(window,"google","maps","Geocoder")){geocoder=new google.maps.Geocoder;return callback()}acs.addAction("google_map_api_loaded",callback);if(loading){return}var url=acs.get("google_map_api");if(url){loading=true;$.ajax({url:url,dataType:"script",cache:true,success:function(){geocoder=new google.maps.Geocoder;acs.doAction("google_map_api_loaded")}})}}})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"image",$control:function(){return this.$(".acs-image-uploader")},$input:function(){return this.$('input[type="hidden"]')},events:{'click a[data-name="add"]':"onClickAdd",'click a[data-name="edit"]':"onClickEdit",'click a[data-name="remove"]':"onClickRemove",'change input[type="file"]':"onChange"},initialize:function(){if(this.get("uploader")==="basic"){this.$el.closest("form").attr("enctype","multipart/form-data")}},validateAttachment:function(attachment){if(attachment&&attachment.attributes){attachment=attachment.attributes}attachment=acs.parseArgs(attachment,{id:0,url:"",alt:"",title:"",caption:"",description:"",width:0,height:0});var size=acs.isget(attachment,"sizes",this.get("preview_size"));if(size){attachment.url=size.url;attachment.width=size.width;attachment.height=size.height}return attachment},render:function(attachment){attachment=this.validateAttachment(attachment);this.$("img").attr({src:attachment.url,alt:attachment.alt});if(attachment.id){this.val(attachment.id);this.$control().addClass("has-value")}else{this.val("");this.$control().removeClass("has-value")}},append:function(attachment,parent){var getNext=function(field,parent){var fields=acs.getFields({key:field.get("key"),parent:parent.$el});for(var i=0;i<fields.length;i++){if(!fields[i].val()){return fields[i]}}return false};var field=getNext(this,parent);if(!field){parent.$(".acs-button:last").trigger("click");field=getNext(this,parent)}if(field){field.render(attachment)}},selectAttachment:function(){var parent=this.parent();var multiple=parent&&parent.get("type")==="repeater";var frame=acs.newMediaPopup({mode:"select",type:"image",title:acs.__("Select Image"),field:this.get("key"),multiple:multiple,library:this.get("library"),allowedTypes:this.get("mime_types"),select:$.proxy(function(attachment,i){if(i>0){this.append(attachment,parent)}else{this.render(attachment)}},this)})},editAttachment:function(){var val=this.val();if(!val)return;var frame=acs.newMediaPopup({mode:"edit",title:acs.__("Edit Image"),button:acs.__("Update Image"),attachment:val,field:this.get("key"),select:$.proxy(function(attachment,i){this.render(attachment)},this)})},removeAttachment:function(){this.render(false)},onClickAdd:function(e,$el){this.selectAttachment()},onClickEdit:function(e,$el){this.editAttachment()},onClickRemove:function(e,$el){this.removeAttachment()},onChange:function(e,$el){var $hiddenInput=this.$input();acs.getFileInputData($el,function(data){$hiddenInput.val($.param(data))})}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.models.ImageField.extend({type:"file",$control:function(){return this.$(".acs-file-uploader")},$input:function(){return this.$('input[type="hidden"]')},validateAttachment:function(attachment){attachment=attachment||{};if(attachment.id!==undefined){attachment=attachment.attributes}attachment=acs.parseArgs(attachment,{url:"",alt:"",title:"",filename:"",filesizeHumanReadable:"",icon:"/wp-includes/images/media/default.png"});return attachment},render:function(attachment){attachment=this.validateAttachment(attachment);this.$("img").attr({src:attachment.icon,alt:attachment.alt,title:attachment.title});this.$('[data-name="title"]').text(attachment.title);this.$('[data-name="filename"]').text(attachment.filename).attr("href",attachment.url);this.$('[data-name="filesize"]').text(attachment.filesizeHumanReadable);var val=attachment.id||"";acs.val(this.$input(),val);if(val){this.$control().addClass("has-value")}else{this.$control().removeClass("has-value")}},selectAttachment:function(){var parent=this.parent();var multiple=parent&&parent.get("type")==="repeater";var frame=acs.newMediaPopup({mode:"select",title:acs.__("Select File"),field:this.get("key"),multiple:multiple,library:this.get("library"),allowedTypes:this.get("mime_types"),select:$.proxy(function(attachment,i){if(i>0){this.append(attachment,parent)}else{this.render(attachment)}},this)})},editAttachment:function(){var val=this.val();if(!val){return false}var frame=acs.newMediaPopup({mode:"edit",title:acs.__("Edit File"),button:acs.__("Update File"),attachment:val,field:this.get("key"),select:$.proxy(function(attachment,i){this.render(attachment)},this)})}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"link",events:{'click a[data-name="add"]':"onClickEdit",'click a[data-name="edit"]':"onClickEdit",'click a[data-name="remove"]':"onClickRemove","change .link-node":"onChange"},$control:function(){return this.$(".acs-link")},$node:function(){return this.$(".link-node")},getValue:function(){var $node=this.$node();if(!$node.attr("href")){return false}return{title:$node.html(),url:$node.attr("href"),target:$node.attr("target")}},setValue:function(val){val=acs.parseArgs(val,{title:"",url:"",target:""});var $div=this.$control();var $node=this.$node();$div.removeClass("-value -external");if(val.url)$div.addClass("-value");if(val.target==="_blank")$div.addClass("-external");this.$(".link-title").html(val.title);this.$(".link-url").attr("href",val.url).html(val.url);$node.html(val.title);$node.attr("href",val.url);$node.attr("target",val.target);this.$(".input-title").val(val.title);this.$(".input-target").val(val.target);this.$(".input-url").val(val.url).trigger("change")},onClickEdit:function(e,$el){acs.wpLink.open(this.$node())},onClickRemove:function(e,$el){this.setValue(false)},onChange:function(e,$el){var val=this.getValue();this.setValue(val)}});acs.registerFieldType(Field);acs.wpLink=new acs.Model({getNodeValue:function(){var $node=this.get("node");return{title:acs.decode($node.html()),url:$node.attr("href"),target:$node.attr("target")}},setNodeValue:function(val){var $node=this.get("node");$node.text(val.title);$node.attr("href",val.url);$node.attr("target",val.target);$node.trigger("change")},getInputValue:function(){return{title:$("#wp-link-text").val(),url:$("#wp-link-url").val(),target:$("#wp-link-target").prop("checked")?"_blank":""}},setInputValue:function(val){$("#wp-link-text").val(val.title);$("#wp-link-url").val(val.url);$("#wp-link-target").prop("checked",val.target==="_blank")},open:function($node){this.on("wplink-open","onOpen");this.on("wplink-close","onClose");this.set("node",$node);var $textarea=$('<textarea id="acs-link-textarea" style="display:none;"></textarea>');$("body").append($textarea);var val=this.getNodeValue();wpLink.open("acs-link-textarea",val.url,val.title,null)},onOpen:function(){$("#wp-link-wrap").addClass("has-text-field");var val=this.getNodeValue();this.setInputValue(val);if(val.url&&wpLinkL10n){$("#wp-link-submit").val(wpLinkL10n.update)}},close:function(){wpLink.close()},onClose:function(){if(!this.has("node")){return false}var $submit=$("#wp-link-submit");var isSubmit=$submit.is(":hover")||$submit.is(":focus");if(isSubmit){var val=this.getInputValue();this.setNodeValue(val)}this.off("wplink-open");this.off("wplink-close");$("#acs-link-textarea").remove();this.set("node",null)}})})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"oembed",events:{'click [data-name="clear-button"]':"onClickClear","keypress .input-search":"onKeypressSearch","keyup .input-search":"onKeyupSearch","change .input-search":"onChangeSearch"},$control:function(){return this.$(".acs-oembed")},$input:function(){return this.$(".input-value")},$search:function(){return this.$(".input-search")},getValue:function(){return this.$input().val()},getSearchVal:function(){return this.$search().val()},setValue:function(val){if(val){this.$control().addClass("has-value")}else{this.$control().removeClass("has-value")}acs.val(this.$input(),val)},showLoading:function(show){acs.showLoading(this.$(".canvas"))},hideLoading:function(){acs.hideLoading(this.$(".canvas"))},maybeSearch:function(){var prevUrl=this.val();var url=this.getSearchVal();if(!url){return this.clear()}if(url.substr(0,4)!="http"){url="http://"+url}if(url===prevUrl)return;var timeout=this.get("timeout");if(timeout){clearTimeout(timeout)}var callback=$.proxy(this.search,this,url);this.set("timeout",setTimeout(callback,300))},search:function(url){var ajaxData={action:"acs/fields/oembed/search",s:url,field_key:this.get("key")};var xhr=this.get("xhr");if(xhr){xhr.abort()}this.showLoading();var xhr=$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"json",context:this,success:function(json){if(!json||!json.html){json={url:false,html:""}}this.val(json.url);this.$(".canvas-media").html(json.html)},complete:function(){this.hideLoading()}});this.set("xhr",xhr)},clear:function(){this.val("");this.$search().val("");this.$(".canvas-media").html("")},onClickClear:function(e,$el){this.clear()},onKeypressSearch:function(e,$el){if(e.which==13){e.preventDefault();this.maybeSearch()}},onKeyupSearch:function(e,$el){if($el.val()){this.maybeSearch()}},onChangeSearch:function(e,$el){this.maybeSearch()}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"radio",events:{'click input[type="radio"]':"onClick"},$control:function(){return this.$(".acs-radio-list")},$input:function(){return this.$("input:checked")},$inputText:function(){return this.$('input[type="text"]')},getValue:function(){var val=this.$input().val();if(val==="other"&&this.get("other_choice")){val=this.$inputText().val()}return val},onClick:function(e,$el){var $label=$el.parent("label");var selected=$label.hasClass("selected");var val=$el.val();this.$(".selected").removeClass("selected");$label.addClass("selected");if(this.get("allow_null")&&selected){$label.removeClass("selected");$el.prop("checked",false).trigger("change");val=false}if(this.get("other_choice")){if(val==="other"){this.$inputText().prop("disabled",false)}else{this.$inputText().prop("disabled",true)}}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"range",events:{'input input[type="range"]':"onChange","change input":"onChange"},$input:function(){return this.$('input[type="range"]')},$inputAlt:function(){return this.$('input[type="number"]')},setValue:function(val){this.busy=true;acs.val(this.$input(),val);acs.val(this.$inputAlt(),this.$input().val(),true);this.busy=false},onChange:function(e,$el){if(!this.busy){this.setValue($el.val())}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"relationship",events:{"keypress [data-filter]":"onKeypressFilter","change [data-filter]":"onChangeFilter","keyup [data-filter]":"onChangeFilter","click .choices-list .acs-rel-item":"onClickAdd",'click [data-name="remove_item"]':"onClickRemove"},$control:function(){return this.$(".acs-relationship")},$list:function(list){return this.$("."+list+"-list")},$listItems:function(list){return this.$list(list).find(".acs-rel-item")},$listItem:function(list,id){return this.$list(list).find('.acs-rel-item[data-id="'+id+'"]')},getValue:function(){var val=[];this.$listItems("values").each(function(){val.push($(this).data("id"))});return val.length?val:false},newChoice:function(props){return["<li>",'<span data-id="'+props.id+'" class="acs-rel-item">'+props.text+"</span>","</li>"].join("")},newValue:function(props){return["<li>",'<input type="hidden" name="'+this.getInputName()+'[]" value="'+props.id+'" />','<span data-id="'+props.id+'" class="acs-rel-item">'+props.text,'<a href="#" class="acs-icon -minus small dark" data-name="remove_item"></a>',"</span>","</li>"].join("")},initialize:function(){var delayed=this.proxy(acs.once(function(){this.$list("values").sortable({items:"li",forceHelperSize:true,forcePlaceholderSize:true,scroll:true,update:this.proxy(function(){this.$input().trigger("change")})});this.$list("choices").scrollTop(0).on("scroll",this.proxy(this.onScrollChoices));this.fetch()}));this.$el.one("mouseover",delayed);this.$el.one("focus","input",delayed);acs.onceInView(this.$el,delayed)},onScrollChoices:function(e){if(this.get("loading")||!this.get("more")){return}var $list=this.$list("choices");var scrollTop=Math.ceil($list.scrollTop());var scrollHeight=Math.ceil($list[0].scrollHeight);var innerHeight=Math.ceil($list.innerHeight());var paged=this.get("paged")||1;if(scrollTop+innerHeight>=scrollHeight){this.set("paged",paged+1);this.fetch()}},onKeypressFilter:function(e,$el){if(e.which==13){e.preventDefault()}},onChangeFilter:function(e,$el){var val=$el.val();var filter=$el.data("filter");if(this.get(filter)===val){return}this.set(filter,val);this.set("paged",1);if($el.is("select")){this.fetch()}else{this.maybeFetch()}},onClickAdd:function(e,$el){var val=this.val();var max=parseInt(this.get("max"));if($el.hasClass("disabled")){return false}if(max>0&&val&&val.length>=max){this.showNotice({text:acs.__("Maximum values reached ( {max} values )").replace("{max}",max),type:"warning"});return false}$el.addClass("disabled");var html=this.newValue({id:$el.data("id"),text:$el.html()});this.$list("values").append(html);this.$input().trigger("change")},onClickRemove:function(e,$el){e.preventDefault();var $span=$el.parent();var $li=$span.parent();var id=$span.data("id");$li.remove();this.$listItem("choices",id).removeClass("disabled");this.$input().trigger("change")},maybeFetch:function(){var timeout=this.get("timeout");if(timeout){clearTimeout(timeout)}timeout=this.setTimeout(this.fetch,300);this.set("timeout",timeout)},getAjaxData:function(){var ajaxData=this.$control().data();for(var name in ajaxData){ajaxData[name]=this.get(name)}ajaxData.action="acs/fields/relationship/query";ajaxData.field_key=this.get("key");ajaxData=acs.applyFilters("relationship_ajax_data",ajaxData,this);return ajaxData},fetch:function(){var xhr=this.get("xhr");if(xhr){xhr.abort()}var ajaxData=this.getAjaxData();var $choiceslist=this.$list("choices");if(ajaxData.paged==1){$choiceslist.html("")}var $loading=$('<li><i class="acs-loading"></i> '+acs.__("Loading")+"</li>");$choiceslist.append($loading);this.set("loading",true);var onComplete=function(){this.set("loading",false);$loading.remove()};var onSuccess=function(json){if(!json||!json.results||!json.results.length){this.set("more",false);if(this.get("paged")==1){this.$list("choices").append("<li>"+acs.__("No matches found")+"</li>")}return}this.set("more",json.more);var html=this.walkChoices(json.results);var $html=$(html);var val=this.val();if(val&&val.length){val.map(function(id){$html.find('.acs-rel-item[data-id="'+id+'"]').addClass("disabled")})}$choiceslist.append($html);var $prevLabel=false;var $prevList=false;$choiceslist.find(".acs-rel-label").each(function(){var $label=$(this);var $list=$label.siblings("ul");if($prevLabel&&$prevLabel.text()==$label.text()){$prevList.append($list.children());$(this).parent().remove();return}$prevLabel=$label;$prevList=$list})};var xhr=$.ajax({url:acs.get("ajaxurl"),dataType:"json",type:"post",data:acs.prepareForAjax(ajaxData),context:this,success:onSuccess,complete:onComplete});this.set("xhr",xhr)},walkChoices:function(data){var walk=function(data){var html="";if($.isArray(data)){data.map(function(item){html+=walk(item)})}else if($.isPlainObject(data)){if(data.children!==undefined){html+='<li><span class="acs-rel-label">'+acs.escHtml(data.text)+'</span><ul class="acs-bl">';html+=walk(data.children);html+="</ul></li>"}else{html+='<li><span class="acs-rel-item" data-id="'+acs.escAttr(data.id)+'">'+acs.escHtml(data.text)+"</span></li>"}}return html};return walk(data)}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"select",select2:false,wait:"load",events:{removeField:"onRemove",duplicateField:"onDuplicate"},$input:function(){return this.$("select")},initialize:function(){var $select=this.$input();this.inherit($select);if(this.get("ui")){var ajaxAction=this.get("ajax_action");if(!ajaxAction){ajaxAction="acs/fields/"+this.get("type")+"/query"}this.select2=acs.newSelect2($select,{field:this,ajax:this.get("ajax"),multiple:this.get("multiple"),placeholder:this.get("placeholder"),allowNull:this.get("allow_null"),ajaxAction:ajaxAction})}},onRemove:function(){if(this.select2){this.select2.destroy()}},onDuplicate:function(e,$el,$duplicate){if(this.select2){$duplicate.find(".select2-container").remove();$duplicate.find("select").removeClass("select2-hidden-accessible")}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var CONTEXT="tab";var Field=acs.Field.extend({type:"tab",wait:"",tabs:false,tab:false,events:{duplicateField:"onDuplicate"},findFields:function(){return this.$el.nextUntil(".acs-field-tab",".acs-field")},getFields:function(){return acs.getFields(this.findFields())},findTabs:function(){return this.$el.prevAll(".acs-tab-wrap:first")},findTab:function(){return this.$(".acs-tab-button")},initialize:function(){if(this.$el.is("td")){this.events={};return false}var $tabs=this.findTabs();var $tab=this.findTab();var settings=acs.parseArgs($tab.data(),{endpoint:false,placement:"",before:this.$el});if(!$tabs.length||settings.endpoint){this.tabs=new Tabs(settings)}else{this.tabs=$tabs.data("acs")}this.tab=this.tabs.addTab($tab,this)},isActive:function(){return this.tab.isActive()},showFields:function(){this.getFields().map(function(field){field.show(this.cid,CONTEXT);field.hiddenByTab=false},this)},hideFields:function(){this.getFields().map(function(field){field.hide(this.cid,CONTEXT);field.hiddenByTab=this.tab},this)},show:function(lockKey){var visible=acs.Field.prototype.show.apply(this,arguments);if(visible){this.tab.show();this.tabs.refresh()}return visible},hide:function(lockKey){var hidden=acs.Field.prototype.hide.apply(this,arguments);if(hidden){this.tab.hide();if(this.isActive()){this.tabs.reset()}}return hidden},enable:function(lockKey){this.getFields().map(function(field){field.enable(CONTEXT)})},disable:function(lockKey){this.getFields().map(function(field){field.disable(CONTEXT)})},onDuplicate:function(e,$el,$duplicate){if(this.isActive()){$duplicate.prevAll(".acs-tab-wrap:first").remove()}}});acs.registerFieldType(Field);var i=0;var Tabs=acs.Model.extend({tabs:[],active:false,actions:{refresh:"onRefresh"},data:{before:false,placement:"top",index:0,initialized:false},setup:function(settings){$.extend(this.data,settings);this.tabs=[];this.active=false;var placement=this.get("placement");var $before=this.get("before");var $parent=$before.parent();if(placement=="left"&&$parent.hasClass("acs-fields")){$parent.addClass("-sidebar")}if($before.is("tr")){this.$el=$('<tr class="acs-tab-wrap"><td colspan="2"><ul class="acs-hl acs-tab-group"></ul></td></tr>')}else{this.$el=$('<div class="acs-tab-wrap -'+placement+'"><ul class="acs-hl acs-tab-group"></ul></div>')}$before.before(this.$el);this.set("index",i,true);i++},initializeTabs:function(){var tab=this.getVisible().shift();var order=acs.getPreference("this.tabs")||[];var groupIndex=this.get("index");var tabIndex=order[groupIndex];if(this.tabs[tabIndex]&&this.tabs[tabIndex].isVisible()){tab=this.tabs[tabIndex]}if(tab){this.selectTab(tab)}else{this.closeTabs()}this.set("initialized",true)},getVisible:function(){return this.tabs.filter(function(tab){return tab.isVisible()})},getActive:function(){return this.active},setActive:function(tab){return this.active=tab},hasActive:function(){return this.active!==false},isActive:function(tab){var active=this.getActive();return active&&active.cid===tab.cid},closeActive:function(){if(this.hasActive()){this.closeTab(this.getActive())}},openTab:function(tab){this.closeActive();tab.open();this.setActive(tab)},closeTab:function(tab){tab.close();this.setActive(false)},closeTabs:function(){this.tabs.map(this.closeTab,this)},selectTab:function(tab){this.tabs.map(function(t){if(tab.cid!==t.cid){this.closeTab(t)}},this);this.openTab(tab)},addTab:function($a,field){var $li=$("<li>"+$a.outerHTML()+"</li>");this.$("ul").append($li);var tab=new Tab({$el:$li,field:field,group:this});this.tabs.push(tab);return tab},reset:function(){this.closeActive();return this.refresh()},refresh:function(){if(this.hasActive()){return false}var tab=this.getVisible().shift();if(tab){this.openTab(tab)}return tab},onRefresh:function(){if(this.get("placement")!=="left"){return}var $parent=this.$el.parent();var $list=this.$el.children("ul");var attribute=$parent.is("td")?"height":"min-height";var height=$list.position().top+$list.outerHeight(true)-1;$parent.css(attribute,height)}});var Tab=acs.Model.extend({group:false,field:false,events:{"click a":"onClick"},index:function(){return this.$el.index()},isVisible:function(){return acs.isVisible(this.$el)},isActive:function(){return this.$el.hasClass("active")},open:function(){this.$el.addClass("active");this.field.showFields()},close:function(){this.$el.removeClass("active");this.field.hideFields()},onClick:function(e,$el){e.preventDefault();this.toggle()},toggle:function(){if(this.isActive()){return}this.group.openTab(this)}});var tabsManager=new acs.Model({priority:50,actions:{prepare:"render",append:"render",unload:"onUnload",invalid_field:"onInvalidField"},findTabs:function(){return $(".acs-tab-wrap")},getTabs:function(){return acs.getInstances(this.findTabs())},render:function($el){this.getTabs().map(function(tabs){if(!tabs.get("initialized")){tabs.initializeTabs()}})},onInvalidField:function(field){if(this.busy){return}if(!field.hiddenByTab){return}field.hiddenByTab.toggle();this.busy=true;this.setTimeout(function(){this.busy=false},100)},onUnload:function(){var order=[];this.getTabs().map(function(group){var active=group.hasActive()?group.getActive().index():0;order.push(active)});if(!order.length){return}acs.setPreference("this.tabs",order)}})})(jQuery);(function($,undefined){var Field=acs.models.SelectField.extend({type:"post_object"});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.models.SelectField.extend({type:"page_link"});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.models.SelectField.extend({type:"user"});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"taxonomy",data:{ftype:"select"},select2:false,wait:"load",events:{'click a[data-name="add"]':"onClickAdd",'click input[type="radio"]':"onClickRadio",removeField:"onRemove"},$control:function(){return this.$(".acs-taxonomy-field")},$input:function(){return this.getRelatedPrototype().$input.apply(this,arguments)},getRelatedType:function(){var fieldType=this.get("ftype");if(fieldType=="multi_select"){fieldType="select"}return fieldType},getRelatedPrototype:function(){return acs.getFieldType(this.getRelatedType()).prototype},getValue:function(){return this.getRelatedPrototype().getValue.apply(this,arguments)},setValue:function(){return this.getRelatedPrototype().setValue.apply(this,arguments)},initialize:function(){this.getRelatedPrototype().initialize.apply(this,arguments)},onRemove:function(){var proto=this.getRelatedPrototype();if(proto.onRemove){proto.onRemove.apply(this,arguments)}},onClickAdd:function(e,$el){var field=this;var popup=false;var $form=false;var $name=false;var $parent=false;var $button=false;var $message=false;var notice=false;var step1=function(){popup=acs.newPopup({title:$el.attr("title"),loading:true,width:"300px"});var ajaxData={action:"acs/fields/taxonomy/add_term",field_key:field.get("key")};$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"html",success:step2})};var step2=function(html){popup.loading(false);popup.content(html);$form=popup.$("form");$name=popup.$('input[name="term_name"]');$parent=popup.$('select[name="term_parent"]');$button=popup.$(".acs-submit-button");$name.focus();popup.on("submit","form",step3)};var step3=function(e,$el){e.preventDefault();e.stopImmediatePropagation();if($name.val()===""){$name.focus();return false}acs.startButtonLoading($button);var ajaxData={action:"acs/fields/taxonomy/add_term",field_key:field.get("key"),term_name:$name.val(),term_parent:$parent.length?$parent.val():0};$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"json",success:step4})};var step4=function(json){acs.stopButtonLoading($button);if(notice){notice.remove()}if(acs.isAjaxSuccess(json)){$name.val("");step5(json.data);notice=acs.newNotice({type:"success",text:acs.getAjaxMessage(json),target:$form,timeout:2e3,dismiss:false})}else{notice=acs.newNotice({type:"error",text:acs.getAjaxError(json),target:$form,timeout:2e3,dismiss:false})}$name.focus()};var step5=function(term){var $option=$('<option value="'+term.term_id+'">'+term.term_label+"</option>");if(term.term_parent){$parent.children('option[value="'+term.term_parent+'"]').after($option)}else{$parent.append($option)}var fields=acs.getFields({type:"taxonomy"});fields.map(function(otherField){if(otherField.get("taxonomy")==field.get("taxonomy")){otherField.appendTerm(term)}});field.selectTerm(term.term_id)};step1()},appendTerm:function(term){if(this.getRelatedType()=="select"){this.appendTermSelect(term)}else{this.appendTermCheckbox(term)}},appendTermSelect:function(term){this.select2.addOption({id:term.term_id,text:term.term_label})},appendTermCheckbox:function(term){var name=this.$("[name]:first").attr("name");var $ul=this.$("ul:first");if(this.getRelatedType()=="checkbox"){name+="[]"}var $li=$(['<li data-id="'+term.term_id+'">',"<label>",'<input type="'+this.get("ftype")+'" value="'+term.term_id+'" name="'+name+'" /> ',"<span>"+term.term_name+"</span>","</label>","</li>"].join(""));if(term.term_parent){var $parent=$ul.find('li[data-id="'+term.term_parent+'"]');$ul=$parent.children("ul");if(!$ul.exists()){$ul=$('<ul class="children acs-bl"></ul>');$parent.append($ul)}}$ul.append($li)},selectTerm:function(id){if(this.getRelatedType()=="select"){this.select2.selectOption(id)}else{var $input=this.$('input[value="'+id+'"]');$input.prop("checked",true).trigger("change")}},onClickRadio:function(e,$el){var $label=$el.parent("label");var selected=$label.hasClass("selected");this.$(".selected").removeClass("selected");$label.addClass("selected");if(this.get("allow_null")&&selected){$label.removeClass("selected");$el.prop("checked",false).trigger("change")}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.models.DatePickerField.extend({type:"time_picker",$control:function(){return this.$(".acs-time-picker")},initialize:function(){var $input=this.$input();var $inputText=this.$inputText();var args={timeFormat:this.get("time_format"),altField:$input,altFieldTimeOnly:false,altTimeFormat:"HH:mm:ss",showButtonPanel:true,controlType:"select",oneLine:true,closeText:acs.get("dateTimePickerL10n").selectText,timeOnly:true};args.onClose=function(value,dp_instance,t_instance){var $close=dp_instance.dpDiv.find(".ui-datepicker-close");if(!value&&$close.is(":hover")){t_instance._updateDateTime()}};args=acs.applyFilters("time_picker_args",args,this);acs.newTimePicker($inputText,args);acs.doAction("time_picker_init",$inputText,args,this)}});acs.registerFieldType(Field);acs.newTimePicker=function($input,args){if(typeof $.timepicker==="undefined"){return false}args=args||{};$input.timepicker(args);if($("body > #ui-datepicker-div").exists()){$("body > #ui-datepicker-div").wrap('<div class="acs-ui-datepicker" />')}}})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"true_false",events:{"change .acs-switch-input":"onChange","focus .acs-switch-input":"onFocus","blur .acs-switch-input":"onBlur","keypress .acs-switch-input":"onKeypress"},$input:function(){return this.$('input[type="checkbox"]')},$switch:function(){return this.$(".acs-switch")},getValue:function(){return this.$input().prop("checked")?1:0},initialize:function(){this.render()},render:function(){var $switch=this.$switch();if(!$switch.length)return;var $on=$switch.children(".acs-switch-on");var $off=$switch.children(".acs-switch-off");var width=Math.max($on.width(),$off.width());if(!width)return;$on.css("min-width",width);$off.css("min-width",width)},switchOn:function(){this.$input().prop("checked",true);this.$switch().addClass("-on")},switchOff:function(){this.$input().prop("checked",false);this.$switch().removeClass("-on")},onChange:function(e,$el){if($el.prop("checked")){this.switchOn()}else{this.switchOff()}},onFocus:function(e,$el){this.$switch().addClass("-focus")},onBlur:function(e,$el){this.$switch().removeClass("-focus")},onKeypress:function(e,$el){if(e.keyCode===37){return this.switchOff()}if(e.keyCode===39){return this.switchOn()}}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"url",events:{'keyup input[type="url"]':"onkeyup"},$control:function(){return this.$(".acs-input-wrap")},$input:function(){return this.$('input[type="url"]')},initialize:function(){this.render()},isValid:function(){var val=this.val();if(!val){return false}if(val.indexOf("://")!==-1){return true}if(val.indexOf("//")===0){return true}return false},render:function(){if(this.isValid()){this.$control().addClass("-valid")}else{this.$control().removeClass("-valid")}},onkeyup:function(e,$el){this.render()}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var Field=acs.Field.extend({type:"wysiwyg",wait:"load",events:{"mousedown .acs-editor-wrap.delay":"onMousedown",unmountField:"disableEditor",remountField:"enableEditor",removeField:"disableEditor"},$control:function(){return this.$(".acs-editor-wrap")},$input:function(){return this.$("textarea")},getMode:function(){return this.$control().hasClass("tmce-active")?"visual":"text"},initialize:function(){if(!this.$control().hasClass("delay")){this.initializeEditor()}},initializeEditor:function(){var $wrap=this.$control();var $textarea=this.$input();var args={tinymce:true,quicktags:true,toolbar:this.get("toolbar"),mode:this.getMode(),field:this};var oldId=$textarea.attr("id");var newId=acs.uniqueId("acs-editor-");var inputData=$textarea.data();var inputVal=$textarea.val();acs.rename({target:$wrap,search:oldId,replace:newId,destructive:true});this.set("id",newId,true);this.$input().data(inputData).val(inputVal);acs.tinymce.initialize(newId,args)},onMousedown:function(e){e.preventDefault();var $wrap=this.$control();$wrap.removeClass("delay");$wrap.find(".acs-editor-toolbar").remove();this.initializeEditor()},enableEditor:function(){if(this.getMode()=="visual"){acs.tinymce.enable(this.get("id"))}},disableEditor:function(){acs.tinymce.destroy(this.get("id"))}});acs.registerFieldType(Field)})(jQuery);(function($,undefined){var storage=[];acs.Condition=acs.Model.extend({type:"",operator:"==",label:"",choiceType:"input",fieldTypes:[],data:{conditions:false,field:false,rule:{}},events:{change:"change",keyup:"change",enableField:"change",disableField:"change"},setup:function(props){$.extend(this.data,props)},getEventTarget:function($el,event){return $el||this.get("field").$el},change:function(e,$el){this.get("conditions").change(e)},match:function(rule,field){return false},calculate:function(){return this.match(this.get("rule"),this.get("field"))},choices:function(field){return'<input type="text" />'}});acs.newCondition=function(rule,conditions){var target=conditions.get("field");var field=target.getField(rule.field);if(!target||!field){return false}var args={rule:rule,target:target,conditions:conditions,field:field};var fieldType=field.get("type");var operator=rule.operator;var conditionTypes=acs.getConditionTypes({fieldType:fieldType,operator:operator});var model=conditionTypes[0]||acs.Condition;var condition=new model(args);return condition};var modelId=function(type){return acs.strPascalCase(type||"")+"Condition"};acs.registerConditionType=function(model){var proto=model.prototype;var type=proto.type;var mid=modelId(type);acs.models[mid]=model;storage.push(type)};acs.getConditionType=function(type){var mid=modelId(type);return acs.models[mid]||false};acs.registerConditionForFieldType=function(conditionType,fieldType){var model=acs.getConditionType(conditionType);if(model){model.prototype.fieldTypes.push(fieldType)}};acs.getConditionTypes=function(args){args=acs.parseArgs(args,{fieldType:"",operator:""});var types=[];storage.map(function(type){var model=acs.getConditionType(type);var ProtoFieldTypes=model.prototype.fieldTypes;var ProtoOperator=model.prototype.operator;if(args.fieldType&&ProtoFieldTypes.indexOf(args.fieldType)===-1){return}if(args.operator&&ProtoOperator!==args.operator){return}types.push(model)});return types}})(jQuery);(function($,undefined){var CONTEXT="conditional_logic";var conditionsManager=new acs.Model({id:"conditionsManager",priority:20,actions:{new_field:"onNewField"},onNewField:function(field){if(field.has("conditions")){field.getConditions().render()}}});var getSiblingField=function(field,key){var fields=acs.getFields({key:key,sibling:field.$el,suppressFilters:true});if(!fields.length){fields=acs.getFields({key:key,parent:field.$el.parent(),suppressFilters:true})}if(fields.length){return fields[0]}return false};acs.Field.prototype.getField=function(key){var field=getSiblingField(this,key);if(field){return field}var parents=this.parents();for(var i=0;i<parents.length;i++){field=getSiblingField(parents[i],key);if(field){return field}}return false};acs.Field.prototype.getConditions=function(){if(!this.conditions){this.conditions=new Conditions(this)}return this.conditions};var timeout=false;var Conditions=acs.Model.extend({id:"Conditions",data:{field:false,timeStamp:false,groups:[]},setup:function(field){this.data.field=field;var conditions=field.get("conditions");if(conditions instanceof Array){if(conditions[0]instanceof Array){conditions.map(function(rules,i){this.addRules(rules,i)},this)}else{this.addRules(conditions)}}else{this.addRule(conditions)}},change:function(e){if(this.get("timeStamp")===e.timeStamp){return false}else{this.set("timeStamp",e.timeStamp,true)}var changed=this.render()},render:function(){return this.calculate()?this.show():this.hide()},show:function(){return this.get("field").showEnable(this.cid,CONTEXT)},hide:function(){return this.get("field").hideDisable(this.cid,CONTEXT)},calculate:function(){var pass=false;this.getGroups().map(function(group){if(pass)return;var passed=group.filter(function(condition){return condition.calculate()});if(passed.length==group.length){pass=true}});return pass},hasGroups:function(){return this.data.groups!=null},getGroups:function(){return this.data.groups},addGroup:function(){var group=[];this.data.groups.push(group);return group},hasGroup:function(i){return this.data.groups[i]!=null},getGroup:function(i){return this.data.groups[i]},removeGroup:function(i){this.data.groups[i].delete;return this},addRules:function(rules,group){rules.map(function(rule){this.addRule(rule,group)},this)},addRule:function(rule,group){group=group||0;var groupArray;if(this.hasGroup(group)){groupArray=this.getGroup(group)}else{groupArray=this.addGroup()}var condition=acs.newCondition(rule,this);if(!condition){return false}groupArray.push(condition)},hasRule:function(){},getRule:function(rule,group){rule=rule||0;group=group||0;return this.data.groups[group][rule]},removeRule:function(){}})})(jQuery);(function($,undefined){var __=acs.__;var parseString=function(val){return val?""+val:""};var isEqualTo=function(v1,v2){return parseString(v1).toLowerCase()===parseString(v2).toLowerCase()};var isEqualToNumber=function(v1,v2){return parseFloat(v1)===parseFloat(v2)};var isGreaterThan=function(v1,v2){return parseFloat(v1)>parseFloat(v2)};var isLessThan=function(v1,v2){return parseFloat(v1)<parseFloat(v2)};var inArray=function(v1,array){array=array.map(function(v2){return parseString(v2)});return array.indexOf(v1)>-1};var containsString=function(haystack,needle){return parseString(haystack).indexOf(parseString(needle))>-1};var matchesPattern=function(v1,pattern){var regexp=new RegExp(parseString(pattern),"gi");return parseString(v1).match(regexp)};var HasValue=acs.Condition.extend({type:"hasValue",operator:"!=empty",label:__("Has any value"),fieldTypes:["text","textarea","number","range","email","url","password","image","file","wysiwyg","oembed","select","checkbox","radio","button_group","link","post_object","page_link","relationship","taxonomy","user","google_map","date_picker","date_time_picker","time_picker","color_picker"],match:function(rule,field){return field.val()?true:false},choices:function(fieldObject){return'<input type="text" disabled="" />'}});acs.registerConditionType(HasValue);var HasNoValue=HasValue.extend({type:"hasNoValue",operator:"==empty",label:__("Has no value"),match:function(rule,field){return!HasValue.prototype.match.apply(this,arguments)}});acs.registerConditionType(HasNoValue);var EqualTo=acs.Condition.extend({type:"equalTo",operator:"==",label:__("Value is equal to"),fieldTypes:["text","textarea","number","range","email","url","password"],match:function(rule,field){if(acs.isNumeric(rule.value)){return isEqualToNumber(rule.value,field.val())}else{return isEqualTo(rule.value,field.val())}},choices:function(fieldObject){return'<input type="text" />'}});acs.registerConditionType(EqualTo);var NotEqualTo=EqualTo.extend({type:"notEqualTo",operator:"!=",label:__("Value is not equal to"),match:function(rule,field){return!EqualTo.prototype.match.apply(this,arguments)}});acs.registerConditionType(NotEqualTo);var PatternMatch=acs.Condition.extend({type:"patternMatch",operator:"==pattern",label:__("Value matches pattern"),fieldTypes:["text","textarea","email","url","password","wysiwyg"],match:function(rule,field){return matchesPattern(field.val(),rule.value)},choices:function(fieldObject){return'<input type="text" placeholder="[a-z0-9]" />'}});acs.registerConditionType(PatternMatch);var Contains=acs.Condition.extend({type:"contains",operator:"==contains",label:__("Value contains"),fieldTypes:["text","textarea","number","email","url","password","wysiwyg","oembed","select"],match:function(rule,field){return containsString(field.val(),rule.value)},choices:function(fieldObject){return'<input type="text" />'}});acs.registerConditionType(Contains);var TrueFalseEqualTo=EqualTo.extend({type:"trueFalseEqualTo",choiceType:"select",fieldTypes:["true_false"],choices:function(field){return[{id:1,text:__("Checked")}]}});acs.registerConditionType(TrueFalseEqualTo);var TrueFalseNotEqualTo=NotEqualTo.extend({type:"trueFalseNotEqualTo",choiceType:"select",fieldTypes:["true_false"],choices:function(field){return[{id:1,text:__("Checked")}]}});acs.registerConditionType(TrueFalseNotEqualTo);var SelectEqualTo=acs.Condition.extend({type:"selectEqualTo",operator:"==",label:__("Value is equal to"),fieldTypes:["select","checkbox","radio","button_group"],match:function(rule,field){var val=field.val();if(val instanceof Array){return inArray(rule.value,val)}else{return isEqualTo(rule.value,val)}},choices:function(fieldObject){var choices=[];var lines=fieldObject.$setting("choices textarea").val().split("\n");if(fieldObject.$input("allow_null").prop("checked")){choices.push({id:"",text:__("Null")})}lines.map(function(line){line=line.split(":");line[1]=line[1]||line[0];choices.push({id:line[0].trim(),text:line[1].trim()})});return choices}});acs.registerConditionType(SelectEqualTo);var SelectNotEqualTo=SelectEqualTo.extend({type:"selectNotEqualTo",operator:"!=",label:__("Value is not equal to"),match:function(rule,field){return!SelectEqualTo.prototype.match.apply(this,arguments)}});acs.registerConditionType(SelectNotEqualTo);var GreaterThan=acs.Condition.extend({type:"greaterThan",operator:">",label:__("Value is greater than"),fieldTypes:["number","range"],match:function(rule,field){var val=field.val();if(val instanceof Array){val=val.length}return isGreaterThan(val,rule.value)},choices:function(fieldObject){return'<input type="number" />'}});acs.registerConditionType(GreaterThan);var LessThan=GreaterThan.extend({type:"lessThan",operator:"<",label:__("Value is less than"),match:function(rule,field){var val=field.val();if(val instanceof Array){val=val.length}return isLessThan(val,rule.value)},choices:function(fieldObject){return'<input type="number" />'}});acs.registerConditionType(LessThan);var SelectionGreaterThan=GreaterThan.extend({type:"selectionGreaterThan",label:__("Selection is greater than"),fieldTypes:["checkbox","select","post_object","page_link","relationship","taxonomy","user"]});acs.registerConditionType(SelectionGreaterThan);var SelectionLessThan=LessThan.extend({type:"selectionLessThan",label:__("Selection is less than"),fieldTypes:["checkbox","select","post_object","page_link","relationship","taxonomy","user"]});acs.registerConditionType(SelectionLessThan)})(jQuery);(function($,undefined){acs.unload=new acs.Model({wait:"load",active:true,changed:false,actions:{validation_failure:"startListening",validation_success:"stopListening"},events:{"change form .acs-field":"startListening","submit form":"stopListening"},enable:function(){this.active=true},disable:function(){this.active=false},reset:function(){this.stopListening()},startListening:function(){if(this.changed||!this.active){return}this.changed=true;$(window).on("beforeunload",this.onUnload)},stopListening:function(){this.changed=false;$(window).off("beforeunload",this.onUnload)},onUnload:function(){return acs.__("The changes you made will be lost if you navigate away from this page")}})})(jQuery);(function($,undefined){var postboxManager=new acs.Model({wait:"prepare",priority:1,initialize:function(){(acs.get("postboxes")||[]).map(acs.newPostbox)}});acs.getPostbox=function($el){if(typeof arguments[0]=="string"){$el=$("#"+arguments[0])}return acs.getInstance($el)};acs.getPostboxes=function(){return acs.getInstances($(".acs-postbox"))};acs.newPostbox=function(props){return new acs.models.Postbox(props)};acs.models.Postbox=acs.Model.extend({data:{id:"",key:"",style:"default",label:"top",edit:""},setup:function(props){if(props.editLink){props.edit=props.editLink}$.extend(this.data,props);this.$el=this.$postbox()},$postbox:function(){return $("#"+this.get("id"))},$hide:function(){return $("#"+this.get("id")+"-hide")},$hideLabel:function(){return this.$hide().parent()},$hndle:function(){return this.$("> .hndle")},$handleActions:function(){return this.$("> .postbox-header .handle-actions")},$inside:function(){return this.$("> .inside")},isVisible:function(){return this.$el.hasClass("acs-hidden")},initialize:function(){this.$el.addClass("acs-postbox");this.$el.removeClass("hide-if-js");if(acs.get("editor")!=="block"){var style=this.get("style");if(style!=="default"){this.$el.addClass(style)}}this.$inside().addClass("acs-fields").addClass("-"+this.get("label"));var edit=this.get("edit");if(edit){var html='<a href="'+edit+'" class="dashicons dashicons-admin-generic acs-hndle-cog acs-js-tooltip" title="'+acs.__("Edit field group")+'"></a>';var $handleActions=this.$handleActions();if($handleActions.length){$handleActions.prepend(html)}else{this.$hndle().append(html)}}this.show()},show:function(){this.$hideLabel().show();this.$hide().prop("checked",true);this.$el.show().removeClass("acs-hidden");acs.doAction("show_postbox",this)},enable:function(){acs.enable(this.$el,"postbox")},showEnable:function(){this.enable();this.show()},hide:function(){this.$hideLabel().hide();this.$el.hide().addClass("acs-hidden");acs.doAction("hide_postbox",this)},disable:function(){acs.disable(this.$el,"postbox")},hideDisable:function(){this.disable();this.hide()},html:function(html){this.$inside().html(html);acs.doAction("append",this.$el)}})})(jQuery);(function($,undefined){acs.newMediaPopup=function(args){var popup=null;var args=acs.parseArgs(args,{mode:"select",title:"",button:"",type:"",field:false,allowedTypes:"",library:"all",multiple:false,attachment:0,autoOpen:true,open:function(){},select:function(){},close:function(){}});if(args.mode=="edit"){popup=new acs.models.EditMediaPopup(args)}else{popup=new acs.models.SelectMediaPopup(args)}if(args.autoOpen){setTimeout(function(){popup.open()},1)}acs.doAction("new_media_popup",popup);return popup};var getPostID=function(){var postID=acs.get("post_id");return acs.isNumeric(postID)?postID:0};acs.getMimeTypes=function(){return this.get("mimeTypes")};acs.getMimeType=function(name){var allTypes=acs.getMimeTypes();if(allTypes[name]!==undefined){return allTypes[name]}for(var key in allTypes){if(key.indexOf(name)!==-1){return allTypes[key]}}return false};var MediaPopup=acs.Model.extend({id:"MediaPopup",data:{},defaults:{},frame:false,setup:function(props){$.extend(this.data,props)},initialize:function(){var options=this.getFrameOptions();this.addFrameStates(options);var frame=wp.media(options);frame.acs=this;this.addFrameEvents(frame,options);this.frame=frame},open:function(){this.frame.open()},close:function(){this.frame.close()},remove:function(){this.frame.detach();this.frame.remove()},getFrameOptions:function(){var options={title:this.get("title"),multiple:this.get("multiple"),library:{},states:[]};if(this.get("type")){options.library.type=this.get("type")}if(this.get("library")==="uploadedTo"){options.library.uploadedTo=getPostID()}if(this.get("attachment")){options.library.post__in=[this.get("attachment")]}if(this.get("button")){options.button={text:this.get("button")}}return options},addFrameStates:function(options){var Query=wp.media.query(options.library);if(this.get("field")&&acs.isset(Query,"mirroring","args")){Query.mirroring.args._acsuploader=this.get("field")}options.states.push(new wp.media.controller.Library({library:Query,multiple:this.get("multiple"),title:this.get("title"),priority:20,filterable:"all",editable:true,allowLocalEdits:true}));if(acs.isset(wp,"media","controller","EditImage")){options.states.push(new wp.media.controller.EditImage)}},addFrameEvents:function(frame,options){frame.on("open",function(){this.$el.closest(".media-modal").addClass("acs-media-modal -"+this.acs.get("mode"))},frame);frame.on("content:render:edit-image",function(){var image=this.state().get("image");var view=new wp.media.view.EditImage({model:image,controller:this}).render();this.content.set(view);view.loadEditor()},frame);frame.on("select",function(){var selection=frame.state().get("selection");if(selection){selection.each(function(attachment,i){frame.acs.get("select").apply(frame.acs,[attachment,i])})}});frame.on("close",function(){setTimeout(function(){frame.acs.get("close").apply(frame.acs);frame.acs.remove()},1)})}});acs.models.SelectMediaPopup=MediaPopup.extend({id:"SelectMediaPopup",setup:function(props){if(!props.button){props.button=acs._x("Select","verb")}MediaPopup.prototype.setup.apply(this,arguments)},addFrameEvents:function(frame,options){if(acs.isset(_wpPluploadSettings,"defaults","multipart_params")){_wpPluploadSettings.defaults.multipart_params._acsuploader=this.get("field");frame.on("open",function(){delete _wpPluploadSettings.defaults.multipart_params._acsuploader})}frame.on("content:activate:browse",function(){var toolbar=false;try{toolbar=frame.content.get().toolbar}catch(e){console.log(e);return}frame.acs.customizeFilters.apply(frame.acs,[toolbar])});MediaPopup.prototype.addFrameEvents.apply(this,arguments)},customizeFilters:function(toolbar){var filters=toolbar.get("filters");if(this.get("type")=="image"){filters.filters.all.text=acs.__("All images");delete filters.filters.audio;delete filters.filters.video;delete filters.filters.image;$.each(filters.filters,function(i,filter){filter.props.type=filter.props.type||"image"})}if(this.get("allowedTypes")){var allowedTypes=this.get("allowedTypes").split(" ").join("").split(".").join("").split(",");allowedTypes.map(function(name){var mimeType=acs.getMimeType(name);if(!mimeType)return;var newFilter={text:mimeType,props:{status:null,type:mimeType,uploadedTo:null,orderby:"date",order:"DESC"},priority:20};filters.filters[mimeType]=newFilter})}if(this.get("library")==="uploadedTo"){var uploadedTo=this.frame.options.library.uploadedTo;delete filters.filters.unattached;delete filters.filters.uploaded;$.each(filters.filters,function(i,filter){filter.text+=" ("+acs.__("Uploaded to this post")+")";filter.props.uploadedTo=uploadedTo})}var field=this.get("field");$.each(filters.filters,function(k,filter){filter.props._acsuploader=field});var search=toolbar.get("search");search.model.attributes._acsuploader=field;if(filters.renderFilters){filters.renderFilters()}}});acs.models.EditMediaPopup=MediaPopup.extend({id:"SelectMediaPopup",setup:function(props){if(!props.button){props.button=acs._x("Update","verb")}MediaPopup.prototype.setup.apply(this,arguments)},addFrameEvents:function(frame,options){frame.on("open",function(){this.$el.closest(".media-modal").addClass("acs-expanded");if(this.content.mode()!="browse"){this.content.mode("browse")}var state=this.state();var selection=state.get("selection");var attachment=wp.media.attachment(frame.acs.get("attachment"));selection.add(attachment)},frame);MediaPopup.prototype.addFrameEvents.apply(this,arguments)}});var customizePrototypes=new acs.Model({id:"customizePrototypes",wait:"ready",initialize:function(){if(!acs.isset(window,"wp","media","view")){return}var postID=getPostID();if(postID&&acs.isset(wp,"media","view","settings","post")){wp.media.view.settings.post.id=postID}this.customizeAttachmentsButton();this.customizeAttachmentsRouter();this.customizeAttachmentFilters();this.customizeAttachmentCompat();this.customizeAttachmentLibrary()},customizeAttachmentsButton:function(){if(!acs.isset(wp,"media","view","Button")){return}var Button=wp.media.view.Button;wp.media.view.Button=Button.extend({initialize:function(){var options=_.defaults(this.options,this.defaults);this.model=new Backbone.Model(options);this.listenTo(this.model,"change",this.render)}})},customizeAttachmentsRouter:function(){if(!acs.isset(wp,"media","view","Router")){return}var Parent=wp.media.view.Router;wp.media.view.Router=Parent.extend({addExpand:function(){var $a=$(['<a href="#" class="acs-expand-details">','<span class="is-closed"><i class="acs-icon -left -small"></i>'+acs.__("Expand Details")+"</span>",'<span class="is-open"><i class="acs-icon -right -small"></i>'+acs.__("Collapse Details")+"</span>","</a>"].join(""));$a.on("click",function(e){e.preventDefault();var $div=$(this).closest(".media-modal");if($div.hasClass("acs-expanded")){$div.removeClass("acs-expanded")}else{$div.addClass("acs-expanded")}});this.$el.append($a)},initialize:function(){Parent.prototype.initialize.apply(this,arguments);this.addExpand();return this}})},customizeAttachmentFilters:function(){if(!acs.isset(wp,"media","view","AttachmentFilters","All")){return}var Parent=wp.media.view.AttachmentFilters.All;Parent.prototype.renderFilters=function(){this.$el.html(_.chain(this.filters).map(function(filter,value){return{el:$("<option></option>").val(value).html(filter.text)[0],priority:filter.priority||50}},this).sortBy("priority").pluck("el").value())}},customizeAttachmentCompat:function(){if(!acs.isset(wp,"media","view","AttachmentCompat")){return}var AttachmentCompat=wp.media.view.AttachmentCompat;var timeout=false;wp.media.view.AttachmentCompat=AttachmentCompat.extend({render:function(){if(this.rendered){return this}AttachmentCompat.prototype.render.apply(this,arguments);if(!this.$("#acs-form-data").length){return this}clearTimeout(timeout);timeout=setTimeout($.proxy(function(){this.rendered=true;acs.doAction("append",this.$el)},this),50);return this},save:function(event){var data={};if(event){event.preventDefault()}data=acs.serializeForAjax(this.$el);this.controller.trigger("attachment:compat:waiting",["waiting"]);this.model.saveCompat(data).always(_.bind(this.postSave,this))}})},customizeAttachmentLibrary:function(){if(!acs.isset(wp,"media","view","Attachment","Library")){return}var AttachmentLibrary=wp.media.view.Attachment.Library;wp.media.view.Attachment.Library=AttachmentLibrary.extend({render:function(){var popup=acs.isget(this,"controller","acs");var attributes=acs.isget(this,"model","attributes");if(popup&&attributes){if(attributes.acs_errors){this.$el.addClass("acs-disabled")}var selected=popup.get("selected");if(selected&&selected.indexOf(attributes.id)>-1){this.$el.addClass("acs-selected")}}return AttachmentLibrary.prototype.render.apply(this,arguments)},toggleSelection:function(options){var collection=this.collection,selection=this.options.selection,model=this.model,single=selection.single();var frame=this.controller;var errors=acs.isget(this,"model","attributes","acs_errors");var $sidebar=frame.$el.find(".media-frame-content .media-sidebar");$sidebar.children(".acs-selection-error").remove();$sidebar.children().removeClass("acs-hidden");if(frame&&errors){var filename=acs.isget(this,"model","attributes","filename");$sidebar.children().addClass("acs-hidden");$sidebar.prepend(['<div class="acs-selection-error">','<span class="selection-error-label">'+acs.__("Restricted")+"</span>",'<span class="selection-error-filename">'+filename+"</span>",'<span class="selection-error-message">'+errors+"</span>","</div>"].join(""));selection.reset();selection.single(model);return}return AttachmentLibrary.prototype.toggleSelection.apply(this,arguments)}})}})})(jQuery);(function($,undefined){acs.screen=new acs.Model({active:true,xhr:false,timeout:false,wait:"load",events:{"change #page_template":"onChange","change #parent_id":"onChange","change #post-formats-select":"onChange","change .categorychecklist":"onChange","change .tagsdiv":"onChange",'change .acs-taxonomy-field[data-save="1"]':"onChange","change #product-type":"onChange"},isPost:function(){return acs.get("screen")==="post"},isUser:function(){return acs.get("screen")==="user"},isTaxonomy:function(){return acs.get("screen")==="taxonomy"},isAttachment:function(){return acs.get("screen")==="attachment"},isNavMenu:function(){return acs.get("screen")==="nav_menu"},isWidget:function(){return acs.get("screen")==="widget"},isComment:function(){return acs.get("screen")==="comment"},getPageTemplate:function(){var $el=$("#page_template");return $el.length?$el.val():null},getPageParent:function(e,$el){var $el=$("#parent_id");return $el.length?$el.val():null},getPageType:function(e,$el){return this.getPageParent()?"child":"parent"},getPostType:function(){return $("#post_type").val()},getPostFormat:function(e,$el){var $el=$("#post-formats-select input:checked");if($el.length){var val=$el.val();return val=="0"?"standard":val}return null},getPostCoreTerms:function(){var terms={};var data=acs.serialize($(".categorydiv, .tagsdiv"));if(data.tax_input){terms=data.tax_input}if(data.post_category){terms.category=data.post_category}for(var tax in terms){if(!acs.isArray(terms[tax])){terms[tax]=terms[tax].split(/,[\s]?/)}}return terms},getPostTerms:function(){var terms=this.getPostCoreTerms();acs.getFields({type:"taxonomy"}).map(function(field){if(!field.get("save")){return}var val=field.val();var tax=field.get("taxonomy");if(val){terms[tax]=terms[tax]||[];val=acs.isArray(val)?val:[val];terms[tax]=terms[tax].concat(val)}});if((productType=this.getProductType())!==null){terms.product_type=[productType]}for(var tax in terms){terms[tax]=acs.uniqueArray(terms[tax])}return terms},getProductType:function(){var $el=$("#product-type");return $el.length?$el.val():null},check:function(){if(acs.get("screen")!=="post"){return}if(this.xhr){this.xhr.abort()}var ajaxData=acs.parseArgs(this.data,{action:"acs/ajax/check_screen",screen:acs.get("screen"),exists:[]});if(this.isPost()){ajaxData.post_id=acs.get("post_id")}if((postType=this.getPostType())!==null){ajaxData.post_type=postType}if((pageTemplate=this.getPageTemplate())!==null){ajaxData.page_template=pageTemplate}if((pageParent=this.getPageParent())!==null){ajaxData.page_parent=pageParent}if((pageType=this.getPageType())!==null){ajaxData.page_type=pageType}if((postFormat=this.getPostFormat())!==null){ajaxData.post_format=postFormat}if((postTerms=this.getPostTerms())!==null){ajaxData.post_terms=postTerms}acs.getPostboxes().map(function(postbox){ajaxData.exists.push(postbox.get("key"))});ajaxData=acs.applyFilters("check_screen_args",ajaxData);var onSuccess=function(json){if(acs.get("screen")=="post"){this.renderPostScreen(json)}else if(acs.get("screen")=="user"){this.renderUserScreen(json)}acs.doAction("check_screen_complete",json,ajaxData)};this.xhr=$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"json",context:this,success:onSuccess})},onChange:function(e,$el){this.setTimeout(this.check,1)},renderPostScreen:function(data){var copyEvents=function($from,$to){var events=$._data($from[0]).events;for(var type in events){for(var i=0;i<events[type].length;i++){$to.on(type,events[type][i].handler)}}};var sortMetabox=function(id,ids){var index=ids.indexOf(id);if(index==-1){return false}for(var i=index-1;i>=0;i--){if($("#"+ids[i]).length){return $("#"+ids[i]).after($("#"+id))}}for(var i=index+1;i<ids.length;i++){if($("#"+ids[i]).length){return $("#"+ids[i]).before($("#"+id))}}return false};data.visible=[];data.hidden=[];data.results=data.results.map(function(result,i){var postbox=acs.getPostbox(result.id);if(acs.isGutenberg()&&result.position=="acs_after_title"){result.position="normal"}if(!postbox){var wpMinorVersion=parseFloat(acs.get("wp_version"));if(wpMinorVersion>=5.5){var postboxHeader=['<div class="postbox-header">','<h2 class="hndle ui-sortable-handle">',"<span>"+acs.escHtml(result.title)+"</span>","</h2>",'<div class="handle-actions hide-if-no-js">','<button type="button" class="handlediv" aria-expanded="true">','<span class="screen-reader-text">Toggle panel: '+acs.escHtml(result.title)+"</span>",'<span class="toggle-indicator" aria-hidden="true"></span>',"</button>","</div>","</div>"].join("")}else{var postboxHeader=['<button type="button" class="handlediv" aria-expanded="true">','<span class="screen-reader-text">Toggle panel: '+acs.escHtml(result.title)+"</span>",'<span class="toggle-indicator" aria-hidden="true"></span>',"</button>",'<h2 class="hndle ui-sortable-handle">',"<span>"+acs.escHtml(result.title)+"</span>","</h2>"].join("")}var $postbox=$(['<div id="'+result.id+'" class="postbox">',postboxHeader,'<div class="inside">',result.html,"</div>","</div>"].join(""));if($("#adv-settings").length){var $prefs=$("#adv-settings .metabox-prefs");var $label=$(['<label for="'+result.id+'-hide">','<input class="hide-postbox-tog" name="'+result.id+'-hide" type="checkbox" id="'+result.id+'-hide" value="'+result.id+'" checked="checked">'," "+result.title,"</label>"].join(""));copyEvents($prefs.find("input").first(),$label.find("input"));$prefs.append($label)}if($(".postbox").length){copyEvents($(".postbox .handlediv").first(),$postbox.children(".handlediv"));copyEvents($(".postbox .hndle").first(),$postbox.children(".hndle"))}if(result.position==="side"){$("#"+result.position+"-sortables").append($postbox)}else{$("#"+result.position+"-sortables").prepend($postbox)}var order=[];data.results.map(function(_result){if(result.position===_result.position&&$("#"+result.position+"-sortables #"+_result.id).length){order.push(_result.id)}});sortMetabox(result.id,order);if(data.sorted){for(var position in data.sorted){var order=data.sorted[position].split(",");if(sortMetabox(result.id,order)){break}}}postbox=acs.newPostbox(result);acs.doAction("append",$postbox);acs.doAction("append_postbox",postbox)}postbox.showEnable();data.visible.push(result.id);return result});acs.getPostboxes().map(function(postbox){if(data.visible.indexOf(postbox.get("id"))===-1){postbox.hideDisable();data.hidden.push(postbox.get("id"))}});$("#acs-style").html(data.style);acs.doAction("refresh_post_screen",data)},renderUserScreen:function(json){}});var gutenScreen=new acs.Model({postEdits:{},wait:"prepare",initialize:function(){if(!acs.isGutenberg()){return}wp.data.subscribe(acs.debounce(this.onChange).bind(this));acs.screen.getPageTemplate=this.getPageTemplate;acs.screen.getPageParent=this.getPageParent;acs.screen.getPostType=this.getPostType;acs.screen.getPostFormat=this.getPostFormat;acs.screen.getPostCoreTerms=this.getPostCoreTerms;acs.unload.disable();var wpMinorVersion=parseFloat(acs.get("wp_version"));if(wpMinorVersion>=5.3){this.addAction("refresh_post_screen",this.onRefreshPostScreen)}wp.domReady(acs.refresh)},onChange:function(){var attributes=["template","parent","format"];(wp.data.select("core").getTaxonomies()||[]).map(function(taxonomy){attributes.push(taxonomy.rest_base)});var _postEdits=wp.data.select("core/editor").getPostEdits();var postEdits={};attributes.map(function(k){if(_postEdits[k]!==undefined){postEdits[k]=_postEdits[k]}});if(JSON.stringify(postEdits)!==JSON.stringify(this.postEdits)){this.postEdits=postEdits;acs.screen.check()}},getPageTemplate:function(){return wp.data.select("core/editor").getEditedPostAttribute("template")},getPageParent:function(e,$el){return wp.data.select("core/editor").getEditedPostAttribute("parent")},getPostType:function(){return wp.data.select("core/editor").getEditedPostAttribute("type")},getPostFormat:function(e,$el){return wp.data.select("core/editor").getEditedPostAttribute("format")},getPostCoreTerms:function(){var terms={};var taxonomies=wp.data.select("core").getTaxonomies()||[];taxonomies.map(function(taxonomy){var postTerms=wp.data.select("core/editor").getEditedPostAttribute(taxonomy.rest_base);if(postTerms){terms[taxonomy.slug]=postTerms}});return terms},onRefreshPostScreen:function(data){var select=wp.data.select("core/edit-post");var dispatch=wp.data.dispatch("core/edit-post");var locations={};select.getActiveMetaBoxLocations().map(function(location){locations[location]=select.getMetaBoxesPerLocation(location)});var ids=[];for(var k in locations){locations[k].map(function(m){ids.push(m.id)})}data.results.filter(function(r){return ids.indexOf(r.id)===-1}).map(function(result,i){var location=result.position;locations[location]=locations[location]||[];locations[location].push({id:result.id,title:result.title})});for(var k in locations){locations[k]=locations[k].filter(function(m){return data.hidden.indexOf(m.id)===-1})}dispatch.setAvailableMetaBoxesPerLocation(locations)}})})(jQuery);(function($,undefined){acs.newSelect2=function($select,props){props=acs.parseArgs(props,{allowNull:false,placeholder:"",multiple:false,field:false,ajax:false,ajaxAction:"",ajaxData:function(data){return data},ajaxResults:function(json){return json}});if(getVersion()==4){var select2=new Select2_4($select,props)}else{var select2=new Select2_3($select,props)}acs.doAction("new_select2",select2);return select2};function getVersion(){if(acs.isset(window,"jQuery","fn","select2","amd")){return 4}if(acs.isset(window,"Select2")){return 3}return false}var Select2=acs.Model.extend({setup:function($select,props){$.extend(this.data,props);this.$el=$select},initialize:function(){},selectOption:function(value){var $option=this.getOption(value);if(!$option.prop("selected")){$option.prop("selected",true).trigger("change")}},unselectOption:function(value){var $option=this.getOption(value);if($option.prop("selected")){$option.prop("selected",false).trigger("change")}},getOption:function(value){return this.$('option[value="'+value+'"]')},addOption:function(option){option=acs.parseArgs(option,{id:"",text:"",selected:false});var $option=this.getOption(option.id);if(!$option.length){$option=$("<option></option>");$option.html(option.text);$option.attr("value",option.id);$option.prop("selected",option.selected);this.$el.append($option)}return $option},getValue:function(){var val=[];var $options=this.$el.find("option:selected");if(!$options.exists()){return val}$options=$options.sort(function(a,b){return+a.getAttribute("data-i")-+b.getAttribute("data-i")});$options.each(function(){var $el=$(this);val.push({$el:$el,id:$el.attr("value"),text:$el.text()})});return val},mergeOptions:function(){},getChoices:function(){var crawl=function($parent){var choices=[];$parent.children().each(function(){var $child=$(this);if($child.is("optgroup")){choices.push({text:$child.attr("label"),children:crawl($child)})}else{choices.push({id:$child.attr("value"),text:$child.text()})}});return choices};return crawl(this.$el)},getAjaxData:function(params){var ajaxData={action:this.get("ajaxAction"),s:params.term||"",paged:params.page||1};var field=this.get("field");if(field){ajaxData.field_key=field.get("key")}var callback=this.get("ajaxData");if(callback){ajaxData=callback.apply(this,[ajaxData,params])}ajaxData=acs.applyFilters("select2_ajax_data",ajaxData,this.data,this.$el,field||false,this);return acs.prepareForAjax(ajaxData)},getAjaxResults:function(json,params){json=acs.parseArgs(json,{results:false,more:false});var callback=this.get("ajaxResults");if(callback){json=callback.apply(this,[json,params])}json=acs.applyFilters("select2_ajax_results",json,params,this);return json},processAjaxResults:function(json,params){var json=this.getAjaxResults(json,params);if(json.more){json.pagination={more:true}}setTimeout($.proxy(this.mergeOptions,this),1);return json},destroy:function(){if(this.$el.data("select2")){this.$el.select2("destroy")}this.$el.siblings(".select2-container").remove()}});var Select2_4=Select2.extend({initialize:function(){var $select=this.$el;var options={width:"100%",allowClear:this.get("allowNull"),placeholder:this.get("placeholder"),multiple:this.get("multiple"),data:[],escapeMarkup:function(string){return acs.escHtml(string)}};if(options.multiple){this.getValue().map(function(item){item.$el.detach().appendTo($select)})}var attrAjax=$select.attr("data-ajax");if(attrAjax!==undefined){$select.removeData("ajax");$select.removeAttr("data-ajax")}if(this.get("ajax")){options.ajax={url:acs.get("ajaxurl"),delay:250,dataType:"json",type:"post",cache:false,data:$.proxy(this.getAjaxData,this),processResults:$.proxy(this.processAjaxResults,this)}}var field=this.get("field");options=acs.applyFilters("select2_args",options,$select,this.data,field||false,this);$select.select2(options);var $container=$select.next(".select2-container");if(options.multiple){var $ul=$container.find("ul");$ul.sortable({stop:function(e){$ul.find(".select2-selection__choice").each(function(){var $option=$($(this).data("data").element);$option.detach().appendTo($select)});$select.trigger("change")}});$select.on("select2:select",this.proxy(function(e){this.getOption(e.params.data.id).detach().appendTo(this.$el)}))}$container.addClass("-acs");if(attrAjax!==undefined){$select.attr("data-ajax",attrAjax)}acs.doAction("select2_init",$select,options,this.data,field||false,this)},mergeOptions:function(){var $prevOptions=false;var $prevGroup=false;$('.select2-results__option[role="group"]').each(function(){var $options=$(this).children("ul");var $group=$(this).children("strong");if($prevGroup&&$prevGroup.text()===$group.text()){$prevOptions.append($options.children());$(this).remove();return}$prevOptions=$options;$prevGroup=$group})}});var Select2_3=Select2.extend({initialize:function(){var $select=this.$el;var value=this.getValue();var multiple=this.get("multiple");var options={width:"100%",allowClear:this.get("allowNull"),placeholder:this.get("placeholder"),separator:"||",multiple:this.get("multiple"),data:this.getChoices(),escapeMarkup:function(string){return acs.escHtml(string)},dropdownCss:{"z-index":"999999999"},initSelection:function(element,callback){if(multiple){callback(value)}else{callback(value.shift())}}};var $input=$select.siblings("input");if(!$input.length){$input=$('<input type="hidden" />');$select.before($input)}inputValue=value.map(function(item){return item.id}).join("||");$input.val(inputValue);if(options.multiple){value.map(function(item){item.$el.detach().appendTo($select)})}if(options.allowClear){options.data=options.data.filter(function(item){return item.id!==""})}$select.removeData("ajax");$select.removeAttr("data-ajax");if(this.get("ajax")){options.ajax={url:acs.get("ajaxurl"),quietMillis:250,dataType:"json",type:"post",cache:false,data:$.proxy(this.getAjaxData,this),results:$.proxy(this.processAjaxResults,this)}}var field=this.get("field");options=acs.applyFilters("select2_args",options,$select,this.data,field||false,this);$input.select2(options);var $container=$input.select2("container");var getOption=$.proxy(this.getOption,this);if(options.multiple){var $ul=$container.find("ul");$ul.sortable({stop:function(){$ul.find(".select2-search-choice").each(function(){var data=$(this).data("select2Data");var $option=getOption(data.id);$option.detach().appendTo($select)});$select.trigger("change")}})}$input.on("select2-selecting",function(e){var item=e.choice;var $option=getOption(item.id);if(!$option.length){$option=$('<option value="'+item.id+'">'+item.text+"</option>")}$option.detach().appendTo($select)});$container.addClass("-acs");acs.doAction("select2_init",$select,options,this.data,field||false,this);$input.on("change",function(){var val=$input.val();if(val.indexOf("||")){val=val.split("||")}$select.val(val).trigger("change")});$select.hide()},mergeOptions:function(){var $prevOptions=false;var $prevGroup=false;$("#select2-drop .select2-result-with-children").each(function(){var $options=$(this).children("ul");var $group=$(this).children(".select2-result-label");if($prevGroup&&$prevGroup.text()===$group.text()){$prevGroup.append($options.children());$(this).remove();return}$prevOptions=$options;$prevGroup=$group})},getAjaxData:function(term,page){var params={term:term,page:page};return Select2.prototype.getAjaxData.apply(this,[params])}});var select2Manager=new acs.Model({priority:5,wait:"prepare",actions:{duplicate:"onDuplicate"},initialize:function(){var locale=acs.get("locale");var rtl=acs.get("rtl");var l10n=acs.get("select2L10n");var version=getVersion();if(!l10n){return false}if(locale.indexOf("en")===0){return false}if(version==4){this.addTranslations4()}else if(version==3){this.addTranslations3()}},addTranslations4:function(){var l10n=acs.get("select2L10n");var locale=acs.get("locale");locale=locale.replace("_","-");var select2L10n={errorLoading:function(){return l10n.load_fail},inputTooLong:function(args){var overChars=args.input.length-args.maximum;if(overChars>1){return l10n.input_too_long_n.replace("%d",overChars)}return l10n.input_too_long_1},inputTooShort:function(args){var remainingChars=args.minimum-args.input.length;if(remainingChars>1){return l10n.input_too_short_n.replace("%d",remainingChars)}return l10n.input_too_short_1},loadingMore:function(){return l10n.load_more},maximumSelected:function(args){var maximum=args.maximum;if(maximum>1){return l10n.selection_too_long_n.replace("%d",maximum)}return l10n.selection_too_long_1},noResults:function(){return l10n.matches_0},searching:function(){return l10n.searching}};jQuery.fn.select2.amd.define("select2/i18n/"+locale,[],function(){return select2L10n})},addTranslations3:function(){var l10n=acs.get("select2L10n");var locale=acs.get("locale");locale=locale.replace("_","-");var select2L10n={formatMatches:function(matches){if(matches>1){return l10n.matches_n.replace("%d",matches)}return l10n.matches_1},formatNoMatches:function(){return l10n.matches_0},formatAjaxError:function(){return l10n.load_fail},formatInputTooShort:function(input,min){var remainingChars=min-input.length;if(remainingChars>1){return l10n.input_too_short_n.replace("%d",remainingChars)}return l10n.input_too_short_1},formatInputTooLong:function(input,max){var overChars=input.length-max;if(overChars>1){return l10n.input_too_long_n.replace("%d",overChars)}return l10n.input_too_long_1},formatSelectionTooBig:function(maximum){if(maximum>1){return l10n.selection_too_long_n.replace("%d",maximum)}return l10n.selection_too_long_1},formatLoadMore:function(){return l10n.load_more},formatSearching:function(){return l10n.searching}};$.fn.select2.locales=$.fn.select2.locales||{};$.fn.select2.locales[locale]=select2L10n;$.extend($.fn.select2.defaults,select2L10n)},onDuplicate:function($el,$el2){$el2.find(".select2-container").remove()}})})(jQuery);(function($,undefined){acs.tinymce={defaults:function(){if(typeof tinyMCEPreInit==="undefined")return false;var defaults={tinymce:tinyMCEPreInit.mceInit.acs_content,quicktags:tinyMCEPreInit.qtInit.acs_content};return defaults},initialize:function(id,args){args=acs.parseArgs(args,{tinymce:true,quicktags:true,toolbar:"full",mode:"visual",field:false});if(args.tinymce){this.initializeTinymce(id,args)}if(args.quicktags){this.initializeQuicktags(id,args)}},initializeTinymce:function(id,args){var $textarea=$("#"+id);var defaults=this.defaults();var toolbars=acs.get("toolbars");var field=args.field||false;var $field=field.$el||false;if(typeof tinymce==="undefined")return false;if(!defaults)return false;if(tinymce.get(id)){return this.enable(id)}var init=$.extend({},defaults.tinymce,args.tinymce);init.id=id;init.selector="#"+id;var toolbar=args.toolbar;if(toolbar&&toolbars&&toolbars[toolbar]){for(var i=1;i<=4;i++){init["toolbar"+i]=toolbars[toolbar][i]||""}}init.setup=function(ed){ed.on("change",function(e){ed.save();$textarea.trigger("change")});ed.on("mouseup",function(e){var event=new MouseEvent("mouseup");window.dispatchEvent(event)})};init.wp_autoresize_on=false;if(!init.tadv_noautop){init.wpautop=true}init=acs.applyFilters("wysiwyg_tinymce_settings",init,id,field);tinyMCEPreInit.mceInit[id]=init;if(args.mode=="visual"){var result=tinymce.init(init);var ed=tinymce.get(id);if(!ed){return false}ed.acs=args.field;acs.doAction("wysiwyg_tinymce_init",ed,ed.id,init,field)}},initializeQuicktags:function(id,args){var defaults=this.defaults();if(typeof quicktags==="undefined")return false;if(!defaults)return false;var init=$.extend({},defaults.quicktags,args.quicktags);init.id=id;var field=args.field||false;var $field=field.$el||false;init=acs.applyFilters("wysiwyg_quicktags_settings",init,init.id,field);tinyMCEPreInit.qtInit[id]=init;var ed=quicktags(init);if(!ed){return false}this.buildQuicktags(ed);acs.doAction("wysiwyg_quicktags_init",ed,ed.id,init,field)},buildQuicktags:function(ed){var canvas,name,settings,theButtons,html,ed,id,i,use,instanceId,defaults=",strong,em,link,block,del,ins,img,ul,ol,li,code,more,close,";canvas=ed.canvas;name=ed.name;settings=ed.settings;html="";theButtons={};use="";instanceId=ed.id;if(settings.buttons){use=","+settings.buttons+","}for(i in edButtons){if(!edButtons[i]){continue}id=edButtons[i].id;if(use&&defaults.indexOf(","+id+",")!==-1&&use.indexOf(","+id+",")===-1){continue}if(!edButtons[i].instance||edButtons[i].instance===instanceId){theButtons[id]=edButtons[i];if(edButtons[i].html){html+=edButtons[i].html(name+"_")}}}if(use&&use.indexOf(",dfw,")!==-1){theButtons.dfw=new QTags.DFWButton;html+=theButtons.dfw.html(name+"_")}if("rtl"===document.getElementsByTagName("html")[0].dir){theButtons.textdirection=new QTags.TextDirectionButton;html+=theButtons.textdirection.html(name+"_")}ed.toolbar.innerHTML=html;ed.theButtons=theButtons;if(typeof jQuery!=="undefined"){jQuery(document).triggerHandler("quicktags-init",[ed])}},disable:function(id){this.destroyTinymce(id)},remove:function(id){this.destroyTinymce(id)},destroy:function(id){this.destroyTinymce(id)},destroyTinymce:function(id){if(typeof tinymce==="undefined")return false;var ed=tinymce.get(id);if(!ed)return false;ed.save();ed.destroy();return true},enable:function(id){this.enableTinymce(id)},enableTinymce:function(id){if(typeof switchEditors==="undefined")return false;if(typeof tinyMCEPreInit.mceInit[id]==="undefined")return false;$("#"+id).show();switchEditors.go(id,"tmce");return true}};var editorManager=new acs.Model({priority:5,actions:{prepare:"onPrepare",ready:"onReady"},onPrepare:function(){var $div=$("#acs-hidden-wp-editor");if($div.exists()){$div.appendTo("body")}},onReady:function(){if(acs.isset(window,"wp","oldEditor")){wp.editor.autop=wp.oldEditor.autop;wp.editor.removep=wp.oldEditor.removep}if(!acs.isset(window,"tinymce","on"))return;tinymce.on("AddEditor",function(data){var editor=data.editor;if(editor.id.substr(0,3)!=="acs")return;editor=tinymce.editors.content||editor;tinymce.activeEditor=editor;wpActiveEditor=editor.id})}})})(jQuery);(function($,undefined){var Validator=acs.Model.extend({id:"Validator",data:{errors:[],notice:null,status:""},events:{"changed:status":"onChangeStatus"},addErrors:function(errors){errors.map(this.addError,this)},addError:function(error){this.data.errors.push(error)},hasErrors:function(){return this.data.errors.length},clearErrors:function(){return this.data.errors=[]},getErrors:function(){return this.data.errors},getFieldErrors:function(){var errors=[];var inputs=[];this.getErrors().map(function(error){if(!error.input)return;var i=inputs.indexOf(error.input);if(i>-1){errors[i]=error}else{errors.push(error);inputs.push(error.input)}});return errors},getGlobalErrors:function(){return this.getErrors().filter(function(error){return!error.input})},showErrors:function(){if(!this.hasErrors()){return}var fieldErrors=this.getFieldErrors();var globalErrors=this.getGlobalErrors();var errorCount=0;var $scrollTo=false;fieldErrors.map(function(error){var $input=this.$('[name="'+error.input+'"]').first();if(!$input.length){$input=this.$('[name^="'+error.input+'"]').first()}if(!$input.length){return}errorCount++;var field=acs.getClosestField($input);field.showError(error.message);if(!$scrollTo){$scrollTo=field.$el}},this);var errorMessage=acs.__("Validation failed");globalErrors.map(function(error){errorMessage+=". "+error.message});if(errorCount==1){errorMessage+=". "+acs.__("1 field requires attention")}else if(errorCount>1){errorMessage+=". "+acs.__("%d fields require attention").replace("%d",errorCount)}if(this.has("notice")){this.get("notice").update({type:"error",text:errorMessage})}else{var notice=acs.newNotice({type:"error",text:errorMessage,target:this.$el});this.set("notice",notice)}if(!$scrollTo){$scrollTo=this.get("notice").$el}setTimeout(function(){$("html, body").animate({scrollTop:$scrollTo.offset().top-$(window).height()/2},500)},10)},onChangeStatus:function(e,$el,value,prevValue){this.$el.removeClass("is-"+prevValue).addClass("is-"+value)},validate:function(args){args=acs.parseArgs(args,{event:false,reset:false,loading:function(){},complete:function(){},failure:function(){},success:function($form){$form.submit()}});if(this.get("status")=="valid"){return true}if(this.get("status")=="validating"){return false}if(!this.$(".acs-field").length){return true}if(args.event){var event=$.Event(null,args.event);args.success=function(){acs.enableSubmit($(event.target)).trigger(event)}}acs.doAction("validation_begin",this.$el);acs.lockForm(this.$el);args.loading(this.$el,this);this.set("status","validating");var onSuccess=function(json){if(!acs.isAjaxSuccess(json)){return}var data=acs.applyFilters("validation_complete",json.data,this.$el,this);if(!data.valid){this.addErrors(data.errors)}};var onComplete=function(){acs.unlockForm(this.$el);if(this.hasErrors()){this.set("status","invalid");acs.doAction("validation_failure",this.$el,this);this.showErrors();args.failure(this.$el,this)}else{this.set("status","valid");if(this.has("notice")){this.get("notice").update({type:"success",text:acs.__("Validation successful"),timeout:1e3})}acs.doAction("validation_success",this.$el,this);acs.doAction("submit",this.$el);args.success(this.$el,this);acs.lockForm(this.$el);if(args.reset){this.reset()}}args.complete(this.$el,this);this.clearErrors()};var data=acs.serialize(this.$el);data.action="acs/validate_save_post";$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(data),type:"post",dataType:"json",context:this,success:onSuccess,complete:onComplete});return false},setup:function($form){this.$el=$form},reset:function(){this.set("errors",[]);this.set("notice",null);this.set("status","");acs.unlockForm(this.$el)}});var getValidator=function($el){var validator=$el.data("acs");if(!validator){validator=new Validator($el)}return validator};acs.validateForm=function(args){return getValidator(args.form).validate(args)};acs.enableSubmit=function($submit){return $submit.removeClass("disabled")};acs.disableSubmit=function($submit){return $submit.addClass("disabled")};acs.showSpinner=function($spinner){$spinner.addClass("is-active");$spinner.css("display","inline-block");return $spinner};acs.hideSpinner=function($spinner){$spinner.removeClass("is-active");$spinner.css("display","none");return $spinner};acs.lockForm=function($form){var $wrap=findSubmitWrap($form);var $submit=$wrap.find('.button, [type="submit"]');var $spinner=$wrap.find(".spinner, .acs-spinner");acs.hideSpinner($spinner);acs.disableSubmit($submit);acs.showSpinner($spinner.last());return $form};acs.unlockForm=function($form){var $wrap=findSubmitWrap($form);var $submit=$wrap.find('.button, [type="submit"]');var $spinner=$wrap.find(".spinner, .acs-spinner");acs.enableSubmit($submit);acs.hideSpinner($spinner);return $form};var findSubmitWrap=function($form){var $wrap=$form.find("#submitdiv");if($wrap.length){return $wrap}var $wrap=$form.find("#submitpost");if($wrap.length){return $wrap}var $wrap=$form.find("p.submit").last();if($wrap.length){return $wrap}var $wrap=$form.find(".acs-form-submit");if($wrap.length){return $wrap}return $form};var submitFormDebounced=acs.debounce(function($form){$form.submit()});acs.validation=new acs.Model({id:"validation",active:true,wait:"prepare",actions:{ready:"addInputEvents",append:"addInputEvents"},events:{'click input[type="submit"]':"onClickSubmit",'click button[type="submit"]':"onClickSubmit","click #save-post":"onClickSave","submit form#post":"onSubmitPost","submit form":"onSubmit"},initialize:function(){if(!acs.get("validation")){this.active=false;this.actions={};this.events={}}},enable:function(){this.active=true},disable:function(){this.active=false},reset:function($form){getValidator($form).reset()},addInputEvents:function($el){if(acs.get("browser")==="safari")return;var $inputs=$(".acs-field [name]",$el);if($inputs.length){this.on($inputs,"invalid","onInvalid")}},onInvalid:function(e,$el){e.preventDefault();var $form=$el.closest("form");if($form.length){getValidator($form).addError({input:$el.attr("name"),message:acs.strEscape(e.target.validationMessage)});submitFormDebounced($form)}},onClickSubmit:function(e,$el){this.set("originalEvent",e)},onClickSave:function(e,$el){this.set("ignore",true)},onClickSubmitGutenberg:function(e,$el){var valid=acs.validateForm({form:$("#editor"),event:e,reset:true,failure:function($form,validator){var $notice=validator.get("notice").$el;$notice.appendTo(".components-notice-list");$notice.find(".acs-notice-dismiss").removeClass("small")}});if(!valid){e.preventDefault();e.stopImmediatePropagation()}},onSubmitPost:function(e,$el){if($("input#wp-preview").val()==="dopreview"){this.set("ignore",true);acs.unlockForm($el)}},onSubmit:function(e,$el){if(!this.active||this.get("ignore")||e.isDefaultPrevented()){return this.allowSubmit()}var valid=acs.validateForm({form:$el,event:this.get("originalEvent")});if(!valid){e.preventDefault()}},allowSubmit:function(){this.set("ignore",false);this.set("originalEvent",false);return true}});var gutenbergValidation=new acs.Model({wait:"prepare",initialize:function(){if(!acs.isGutenberg()){return}this.customizeEditor()},customizeEditor:function(){var editor=wp.data.dispatch("core/editor");var editorSelect=wp.data.select("core/editor");var notices=wp.data.dispatch("core/notices");var savePost=editor.savePost;var useValidation=false;var lastPostStatus="";wp.data.subscribe(function(){var postStatus=editorSelect.getEditedPostAttribute("status");useValidation=postStatus==="publish";lastPostStatus=postStatus!=="publish"?postStatus:lastPostStatus});editor.savePost=function(options){options=options||{};var _this=this;var _args=arguments;return new Promise(function(resolve,reject){if(options.isAutosave||options.isPreview){return resolve("Validation ignored (autosave).")}if(!useValidation){return resolve("Validation ignored (draft).")}var valid=acs.validateForm({form:$("#editor"),reset:true,complete:function($form,validator){editor.unlockPostSaving("acs")},failure:function($form,validator){var notice=validator.get("notice");notices.createErrorNotice(notice.get("text"),{id:"acs-validation",isDismissible:true});notice.remove();if(lastPostStatus){editor.editPost({status:lastPostStatus})}reject("Validation failed.")},success:function(){notices.removeNotice("acs-validation");resolve("Validation success.")}});if(valid){resolve("Validation bypassed.")}else{editor.lockPostSaving("acs")}}).then(function(){return savePost.apply(_this,_args)})}}})})(jQuery);(function($,undefined){var refreshHelper=new acs.Model({priority:90,actions:{new_field:"refresh",show_field:"refresh",hide_field:"refresh",remove_field:"refresh",unmount_field:"refresh",remount_field:"refresh"},refresh:function(){acs.refresh()}});var mountHelper=new acs.Model({priority:1,actions:{sortstart:"onSortstart",sortstop:"onSortstop"},onSortstart:function($item){acs.doAction("unmount",$item)},onSortstop:function($item){acs.doAction("remount",$item)}});var sortableHelper=new acs.Model({actions:{sortstart:"onSortstart"},onSortstart:function($item,$placeholder){if($item.is("tr")){$placeholder.html('<td style="padding:0;" colspan="'+$placeholder.children().length+'"></td>');$item.addClass("acs-sortable-tr-helper");$item.children().each(function(){$(this).width($(this).width())});$placeholder.height($item.height()+"px");$item.removeClass("acs-sortable-tr-helper")}}});var duplicateHelper=new acs.Model({actions:{after_duplicate:"onAfterDuplicate"},onAfterDuplicate:function($el,$el2){var vals=[];$el.find("select").each(function(i){vals.push($(this).val())});$el2.find("select").each(function(i){$(this).val(vals[i])})}});var tableHelper=new acs.Model({id:"tableHelper",priority:20,actions:{refresh:"renderTables"},renderTables:function($el){var self=this;$(".acs-table:visible").each(function(){self.renderTable($(this))})},renderTable:function($table){var $ths=$table.find("> thead > tr:visible > th[data-key]");var $tds=$table.find("> tbody > tr:visible > td[data-key]");if(!$ths.length||!$tds.length){return false}$ths.each(function(i){var $th=$(this);var key=$th.data("key");var $cells=$tds.filter('[data-key="'+key+'"]');var $hidden=$cells.filter(".acs-hidden");$cells.removeClass("acs-empty");if($cells.length===$hidden.length){acs.hide($th)}else{acs.show($th);$hidden.addClass("acs-empty")}});$ths.css("width","auto");$ths=$ths.not(".acs-hidden");var availableWidth=100;var colspan=$ths.length;var $fixedWidths=$ths.filter("[data-width]");$fixedWidths.each(function(){var width=$(this).data("width");$(this).css("width",width+"%");availableWidth-=width});var $auoWidths=$ths.not("[data-width]");if($auoWidths.length){var width=availableWidth/$auoWidths.length;$auoWidths.css("width",width+"%");availableWidth=0}if(availableWidth>0){$ths.last().css("width","auto")}$tds.filter(".-collapsed-target").each(function(){var $td=$(this);if($td.parent().hasClass("-collapsed")){$td.attr("colspan",$ths.length)}else{$td.removeAttr("colspan")}})}});var fieldsHelper=new acs.Model({id:"fieldsHelper",priority:30,actions:{refresh:"renderGroups"},renderGroups:function(){var self=this;$(".acs-fields:visible").each(function(){self.renderGroup($(this))})},renderGroup:function($el){var top=0;var height=0;var $row=$();var $fields=$el.children(".acs-field[data-width]:visible");if(!$fields.length){return false}if($el.hasClass("-left")){$fields.removeAttr("data-width");$fields.css("width","auto");return false}$fields.removeClass("-r0 -c0").css({"min-height":0});$fields.each(function(i){var $field=$(this);var position=$field.position();var thisTop=Math.ceil(position.top);var thisLeft=Math.ceil(position.left);if($row.length&&thisTop>top){$row.css({"min-height":height+"px"});position=$field.position();thisTop=Math.ceil(position.top);thisLeft=Math.ceil(position.left);top=0;height=0;$row=$()}if(acs.get("rtl")){thisLeft=Math.ceil($field.parent().width()-(position.left+$field.outerWidth()))}if(thisTop==0){$field.addClass("-r0")}else if(thisLeft==0){$field.addClass("-c0")}var thisHeight=Math.ceil($field.outerHeight())+1;height=Math.max(height,thisHeight);top=Math.max(top,thisTop);$row=$row.add($field)});if($row.length){$row.css({"min-height":height+"px"})}}});var bodyClassShiftHelper=new acs.Model({id:"bodyClassShiftHelper",events:{keydown:"onKeyDown",keyup:"onKeyUp"},isShiftKey:function(e){return e.keyCode===16},onKeyDown:function(e){if(this.isShiftKey(e)){$("body").addClass("acs-keydown-shift")}},onKeyUp:function(e){if(this.isShiftKey(e)){$("body").removeClass("acs-keydown-shift")}}})})(jQuery);(function($,undefined){acs.newCompatibility=function(instance,compatibilty){compatibilty=compatibilty||{};compatibilty.__proto__=instance.__proto__;instance.__proto__=compatibilty;instance.compatibility=compatibilty;return compatibilty};acs.getCompatibility=function(instance){return instance.compatibility||null};var _acs=acs.newCompatibility(acs,{l10n:{},o:{},fields:{},update:acs.set,add_action:acs.addAction,remove_action:acs.removeAction,do_action:acs.doAction,add_filter:acs.addFilter,remove_filter:acs.removeFilter,apply_filters:acs.applyFilters,parse_args:acs.parseArgs,disable_el:acs.disable,disable_form:acs.disable,enable_el:acs.enable,enable_form:acs.enable,update_user_setting:acs.updateUserSetting,prepare_for_ajax:acs.prepareForAjax,is_ajax_success:acs.isAjaxSuccess,remove_el:acs.remove,remove_tr:acs.remove,str_replace:acs.strReplace,render_select:acs.renderSelect,get_uniqid:acs.uniqid,serialize_form:acs.serialize,esc_html:acs.strEscape,str_sanitize:acs.strSanitize});_acs._e=function(k1,k2){k1=k1||"";k2=k2||"";var compatKey=k2?k1+"."+k2:k1;var compats={"image.select":"Select Image","image.edit":"Edit Image","image.update":"Update Image"};if(compats[compatKey]){return acs.__(compats[compatKey])}var string=this.l10n[k1]||"";if(k2){string=string[k2]||""}return string};_acs.get_selector=function(s){var selector=".acs-field";if(!s){return selector}if($.isPlainObject(s)){if($.isEmptyObject(s)){return selector}else{for(var k in s){s=s[k];break}}}selector+="-"+s;selector=acs.strReplace("_","-",selector);selector=acs.strReplace("field-field-","field-",selector);return selector};_acs.get_fields=function(s,$el,all){var args={is:s||"",parent:$el||false,suppressFilters:all||false};if(args.is){args.is=this.get_selector(args.is)}return acs.findFields(args)};_acs.get_field=function(s,$el){var $fields=this.get_fields.apply(this,arguments);if($fields.length){return $fields.first()}else{return false}};_acs.get_closest_field=function($el,s){return $el.closest(this.get_selector(s))};_acs.get_field_wrap=function($el){return $el.closest(this.get_selector())};_acs.get_field_key=function($field){return $field.data("key")};_acs.get_field_type=function($field){return $field.data("type")};_acs.get_data=function($el,defaults){return acs.parseArgs($el.data(),defaults)};_acs.maybe_get=function(obj,key,value){if(value===undefined){value=null}keys=String(key).split(".");for(var i=0;i<keys.length;i++){if(!obj.hasOwnProperty(keys[i])){return value}obj=obj[keys[i]]}return obj};var compatibleArgument=function(arg){return arg instanceof acs.Field?arg.$el:arg};var compatibleArguments=function(args){return acs.arrayArgs(args).map(compatibleArgument)};var compatibleCallback=function(origCallback){return function(){if(arguments.length){var args=compatibleArguments(arguments)}else{var args=[$(document)]}return origCallback.apply(this,args)}};_acs.add_action=function(action,callback,priority,context){var actions=action.split(" ");var length=actions.length;if(length>1){for(var i=0;i<length;i++){action=actions[i];_acs.add_action.apply(this,arguments)}return this}var callback=compatibleCallback(callback);return acs.addAction.apply(this,arguments)};_acs.add_filter=function(action,callback,priority,context){var callback=compatibleCallback(callback);return acs.addFilter.apply(this,arguments)};_acs.model={actions:{},filters:{},events:{},extend:function(args){var model=$.extend({},this,args);$.each(model.actions,function(name,callback){model._add_action(name,callback)});$.each(model.filters,function(name,callback){model._add_filter(name,callback)});$.each(model.events,function(name,callback){model._add_event(name,callback)});return model},_add_action:function(name,callback){var model=this,data=name.split(" ");var name=data[0]||"",priority=data[1]||10;acs.add_action(name,model[callback],priority,model)},_add_filter:function(name,callback){var model=this,data=name.split(" ");var name=data[0]||"",priority=data[1]||10;acs.add_filter(name,model[callback],priority,model)},_add_event:function(name,callback){var model=this,i=name.indexOf(" "),event=i>0?name.substr(0,i):name,selector=i>0?name.substr(i+1):"";var fn=function(e){e.$el=$(this);if(acs.field_group){e.$field=e.$el.closest(".acs-field-object")}if(typeof model.event==="function"){e=model.event(e)}model[callback].apply(model,arguments)};if(selector){$(document).on(event,selector,fn)}else{$(document).on(event,fn)}},get:function(name,value){value=value||null;if(typeof this[name]!=="undefined"){value=this[name]}return value},set:function(name,value){this[name]=value;if(typeof this["_set_"+name]==="function"){this["_set_"+name].apply(this)}return this}};_acs.field=acs.model.extend({type:"",o:{},$field:null,_add_action:function(name,callback){var model=this;name=name+"_field/type="+model.type;acs.add_action(name,function($field){model.set("$field",$field);model[callback].apply(model,arguments)})},_add_filter:function(name,callback){var model=this;name=name+"_field/type="+model.type;acs.add_filter(name,function($field){model.set("$field",$field);model[callback].apply(model,arguments)})},_add_event:function(name,callback){var model=this,event=name.substr(0,name.indexOf(" ")),selector=name.substr(name.indexOf(" ")+1),context=acs.get_selector(model.type);$(document).on(event,context+" "+selector,function(e){var $el=$(this);var $field=acs.get_closest_field($el,model.type);if(!$field.length)return;if(!$field.is(model.$field)){model.set("$field",$field)}e.$el=$el;e.$field=$field;model[callback].apply(model,[e])})},_set_$field:function(){if(typeof this.focus==="function"){this.focus()}},doFocus:function($field){return this.set("$field",$field)}});var _validation=acs.newCompatibility(acs.validation,{remove_error:function($field){acs.getField($field).removeError()},add_warning:function($field,message){acs.getField($field).showNotice({text:message,type:"warning",timeout:1e3})},fetch:acs.validateForm,enableSubmit:acs.enableSubmit,disableSubmit:acs.disableSubmit,showSpinner:acs.showSpinner,hideSpinner:acs.hideSpinner,unlockForm:acs.unlockForm,lockForm:acs.lockForm});_acs.tooltip={tooltip:function(text,$el){var tooltip=acs.newTooltip({text:text,target:$el});return tooltip.$el},temp:function(text,$el){var tooltip=acs.newTooltip({text:text,target:$el,timeout:250})},confirm:function($el,callback,text,button_y,button_n){var tooltip=acs.newTooltip({confirm:true,text:text,target:$el,confirm:function(){callback(true)},cancel:function(){callback(false)}})},confirm_remove:function($el,callback){var tooltip=acs.newTooltip({confirmRemove:true,target:$el,confirm:function(){callback(true)},cancel:function(){callback(false)}})}};_acs.media=new acs.Model({activeFrame:false,actions:{new_media_popup:"onNewMediaPopup"},frame:function(){return this.activeFrame},onNewMediaPopup:function(popup){this.activeFrame=popup.frame},popup:function(props){if(props.mime_types){props.allowedTypes=props.mime_types}if(props.id){props.attachment=props.id}var popup=acs.newMediaPopup(props);return popup.frame}});_acs.select2={init:function($select,args,$field){if(args.allow_null){args.allowNull=args.allow_null}if(args.ajax_action){args.ajaxAction=args.ajax_action}if($field){args.field=acs.getField($field)}return acs.newSelect2($select,args)},destroy:function($select){return acs.getInstance($select).destroy()}};_acs.postbox={render:function(args){if(args.edit_url){args.editLink=args.edit_url}if(args.edit_title){args.editTitle=args.edit_title}return acs.newPostbox(args)}};acs.newCompatibility(acs.screen,{update:function(){return this.set.apply(this,arguments)},fetch:acs.screen.check});_acs.ajax=acs.screen})(jQuery);(function($){var Field=acs.Field.extend({type:"repeater",wait:"",events:{'click a[data-event="add-row"]':"onClickAdd",'click a[data-event="duplicate-row"]':"onClickDuplicate",'click a[data-event="remove-row"]':"onClickRemove",'click a[data-event="collapse-row"]':"onClickCollapse",showField:"onShow",unloadField:"onUnload",mouseover:"onHover",unloadField:"onUnload"},$control:function(){return this.$(".acs-repeater:first")},$table:function(){return this.$("table:first")},$tbody:function(){return this.$("tbody:first")},$rows:function(){return this.$("tbody:first > tr").not(".acs-clone")},$row:function(index){return this.$("tbody:first > tr:eq("+index+")")},$clone:function(){return this.$("tbody:first > tr.acs-clone")},$actions:function(){return this.$(".acs-actions:last")},$button:function(){return this.$(".acs-actions:last .button")},getValue:function(){return this.$rows().length},allowRemove:function(){var min=parseInt(this.get("min"));return!min||min<this.val()},allowAdd:function(){var max=parseInt(this.get("max"));return!max||max>this.val()},addSortable:function(self){if(this.get("max")==1){return}this.$tbody().sortable({items:"> tr",handle:"> td.order",forceHelperSize:true,forcePlaceholderSize:true,scroll:true,stop:function(event,ui){self.render()},update:function(event,ui){self.$input().trigger("change")}})},addCollapsed:function(){var indexes=preference.load(this.get("key"));if(!indexes){return false}this.$rows().each(function(i){if(indexes.indexOf(i)>-1){$(this).addClass("-collapsed")}})},addUnscopedEvents:function(self){this.on("invalidField",".acs-row",function(e){var $row=$(this);if(self.isCollapsed($row)){self.expand($row)}})},initialize:function(){this.addUnscopedEvents(this);this.addCollapsed();acs.disable(this.$clone(),this.cid);this.render()},render:function(){this.$rows().each(function(i){$(this).find("> .order > span").html(i+1)});var $controll=this.$control();var $button=this.$button();if(this.val()==0){$controll.addClass("-empty")}else{$controll.removeClass("-empty")}if(!this.allowAdd()){$controll.addClass("-max");$button.addClass("disabled")}else{$controll.removeClass("-max");$button.removeClass("disabled")}},validateAdd:function(){if(this.allowAdd()){return true}var max=this.get("max");var text=acs.__("Maximum rows reached ({max} rows)");text=text.replace("{max}",max);this.showNotice({text:text,type:"warning"});return false},onClickAdd:function(e,$el){if(!this.validateAdd()){return false}if($el.hasClass("acs-icon")){this.add({before:$el.closest(".acs-row")})}else{this.add()}},add:function(args){if(!this.allowAdd()){return false}args=acs.parseArgs(args,{before:false});var $el=acs.duplicate({target:this.$clone(),append:this.proxy(function($el,$el2){if(args.before){args.before.before($el2)}else{$el.before($el2)}$el2.removeClass("acs-clone");acs.enable($el2,this.cid);this.render()})});this.$input().trigger("change");return $el},onClickDuplicate:function(e,$el){if(!this.validateAdd()){return false}var $row=$el.closest(".acs-row");this.duplicateRow($row)},duplicateRow:function($row){if(!this.allowAdd()){return false}var fieldKey=this.get("key");var $el=acs.duplicate({target:$row,rename:function(name,value,search,replace){if(name==="id"){return value.replace(fieldKey+"-"+search,fieldKey+"-"+replace)}else{return value.replace(fieldKey+"]["+search,fieldKey+"]["+replace)}},before:function($el){acs.doAction("unmount",$el)},after:function($el,$el2){acs.doAction("remount",$el)}});this.$input().trigger("change");this.render();acs.focusAttention($el);return $el},validateRemove:function(){if(this.allowRemove()){return true}var min=this.get("min");var text=acs.__("Minimum rows reached ({min} rows)");text=text.replace("{min}",min);this.showNotice({text:text,type:"warning"});return false},onClickRemove:function(e,$el){var $row=$el.closest(".acs-row");if(e.shiftKey){return this.remove($row)}$row.addClass("-hover");var tooltip=acs.newTooltip({confirmRemove:true,target:$el,context:this,confirm:function(){this.remove($row)},cancel:function(){$row.removeClass("-hover")}})},remove:function($row){var self=this;acs.remove({target:$row,endHeight:0,complete:function(){self.$input().trigger("change");self.render()}})},isCollapsed:function($row){return $row.hasClass("-collapsed")},collapse:function($row){$row.addClass("-collapsed");acs.doAction("hide",$row,"collapse")},expand:function($row){$row.removeClass("-collapsed");acs.doAction("show",$row,"collapse")},onClickCollapse:function(e,$el){var $row=$el.closest(".acs-row");var isCollpased=this.isCollapsed($row);if(e.shiftKey){$row=this.$rows()}if(isCollpased){this.expand($row)}else{this.collapse($row)}},onShow:function(e,$el,context){var fields=acs.getFields({is:":visible",parent:this.$el});acs.doAction("show_fields",fields)},onUnload:function(){var indexes=[];this.$rows().each(function(i){if($(this).hasClass("-collapsed")){indexes.push(i)}});indexes=indexes.length?indexes:null;preference.save(this.get("key"),indexes)},onHover:function(){this.addSortable(this);this.off("mouseover")}});acs.registerFieldType(Field);acs.registerConditionForFieldType("hasValue","repeater");acs.registerConditionForFieldType("hasNoValue","repeater");acs.registerConditionForFieldType("lessThan","repeater");acs.registerConditionForFieldType("greaterThan","repeater");var preference=new acs.Model({name:"this.collapsedRows",key:function(key,context){var count=this.get(key+context)||0;count++;this.set(key+context,count,true);if(count>1){key+="-"+count}return key},load:function(key){var key=this.key(key,"load");var data=acs.getPreference(this.name);if(data&&data[key]){return data[key]}else{return false}},save:function(key,value){var key=this.key(key,"save");var data=acs.getPreference(this.name)||{};if(value===null){delete data[key]}else{data[key]=value}if($.isEmptyObject(data)){data=null}acs.setPreference(this.name,data)}})})(jQuery);(function($){var Field=acs.Field.extend({type:"flexible_content",wait:"",events:{'click [data-name="add-layout"]':"onClickAdd",'click [data-name="duplicate-layout"]':"onClickDuplicate",'click [data-name="remove-layout"]':"onClickRemove",'click [data-name="collapse-layout"]':"onClickCollapse",showField:"onShow",unloadField:"onUnload",mouseover:"onHover"},$control:function(){return this.$(".acs-flexible-content:first")},$layoutsWrap:function(){return this.$(".acs-flexible-content:first > .values")},$layouts:function(){return this.$(".acs-flexible-content:first > .values > .layout")},$layout:function(index){return this.$(".acs-flexible-content:first > .values > .layout:eq("+index+")")},$clonesWrap:function(){return this.$(".acs-flexible-content:first > .clones")},$clones:function(){return this.$(".acs-flexible-content:first > .clones  > .layout")},$clone:function(name){return this.$('.acs-flexible-content:first > .clones  > .layout[data-layout="'+name+'"]')},$actions:function(){return this.$(".acs-actions:last")},$button:function(){return this.$(".acs-actions:last .button")},$popup:function(){return this.$(".tmpl-popup:last")},getPopupHTML:function(){var html=this.$popup().html();var $html=$(html);var $layouts=this.$layouts();var countLayouts=function(name){return $layouts.filter(function(){return $(this).data("layout")===name}).length};$html.find("[data-layout]").each(function(){var $a=$(this);var min=$a.data("min")||0;var max=$a.data("max")||0;var name=$a.data("layout")||"";var count=countLayouts(name);if(max&&count>=max){$a.addClass("disabled");return}if(min&&count<min){var required=min-count;var title=acs.__("{required} {label} {identifier} required (min {min})");var identifier=acs._n("layout","layouts",required);title=title.replace("{required}",required);title=title.replace("{label}",name);title=title.replace("{identifier}",identifier);title=title.replace("{min}",min);$a.append('<span class="badge" title="'+title+'">'+required+"</span>")}});html=$html.outerHTML();return html},getValue:function(){return this.$layouts().length},allowRemove:function(){var min=parseInt(this.get("min"));return!min||min<this.val()},allowAdd:function(){var max=parseInt(this.get("max"));return!max||max>this.val()},isFull:function(){var max=parseInt(this.get("max"));return max&&this.val()>=max},addSortable:function(self){if(this.get("max")==1){return}this.$layoutsWrap().sortable({items:"> .layout",handle:"> .acs-fc-layout-handle",forceHelperSize:true,forcePlaceholderSize:true,scroll:true,stop:function(event,ui){self.render()},update:function(event,ui){self.$input().trigger("change")}})},addCollapsed:function(){var indexes=preference.load(this.get("key"));if(!indexes){return false}this.$layouts().each(function(i){if(indexes.indexOf(i)>-1){$(this).addClass("-collapsed")}})},addUnscopedEvents:function(self){this.on("invalidField",".layout",function(e){self.onInvalidField(e,$(this))})},initialize:function(){this.addUnscopedEvents(this);this.addCollapsed();acs.disable(this.$clonesWrap(),this.cid);this.render()},render:function(){this.$layouts().each(function(i){$(this).find(".acs-fc-layout-order:first").html(i+1)});if(this.val()==0){this.$control().addClass("-empty")}else{this.$control().removeClass("-empty")}if(this.isFull()){this.$button().addClass("disabled")}else{this.$button().removeClass("disabled")}},onShow:function(e,$el,context){var fields=acs.getFields({is:":visible",parent:this.$el});acs.doAction("show_fields",fields)},validateAdd:function(){if(this.allowAdd()){return true}var max=this.get("max");var text=acs.__("This field has a limit of {max} {label} {identifier}");var identifier=acs._n("layout","layouts",max);text=text.replace("{max}",max);text=text.replace("{label}","");text=text.replace("{identifier}",identifier);this.showNotice({text:text,type:"warning"});return false},onClickAdd:function(e,$el){if(!this.validateAdd()){return false}var $layout=null;if($el.hasClass("acs-icon")){$layout=$el.closest(".layout");$layout.addClass("-hover")}var popup=new Popup({target:$el,targetConfirm:false,text:this.getPopupHTML(),context:this,confirm:function(e,$el){if($el.hasClass("disabled")){return}this.add({layout:$el.data("layout"),before:$layout})},cancel:function(){if($layout){$layout.removeClass("-hover")}}});popup.on("click","[data-layout]","onConfirm")},add:function(args){args=acs.parseArgs(args,{layout:"",before:false});if(!this.allowAdd()){return false}var $el=acs.duplicate({target:this.$clone(args.layout),append:this.proxy(function($el,$el2){if(args.before){args.before.before($el2)}else{this.$layoutsWrap().append($el2)}acs.enable($el2,this.cid);this.render()})});this.$input().trigger("change");return $el},onClickDuplicate:function(e,$el){if(!this.validateAdd()){return false}var $layout=$el.closest(".layout");this.duplicateLayout($layout)},duplicateLayout:function($layout){if(!this.allowAdd()){return false}var fieldKey=this.get("key");var $el=acs.duplicate({target:$layout,rename:function(name,value,search,replace){if(name==="id"){return value.replace(fieldKey+"-"+search,fieldKey+"-"+replace)}else{return value.replace(fieldKey+"]["+search,fieldKey+"]["+replace)}},before:function($el){acs.doAction("unmount",$el)},after:function($el,$el2){acs.doAction("remount",$el)}});this.$input().trigger("change");this.render();acs.focusAttention($el);return $el},validateRemove:function(){if(this.allowRemove()){return true}var min=this.get("min");var text=acs.__("This field requires at least {min} {label} {identifier}");var identifier=acs._n("layout","layouts",min);text=text.replace("{min}",min);text=text.replace("{label}","");text=text.replace("{identifier}",identifier);this.showNotice({text:text,type:"warning"});return false},onClickRemove:function(e,$el){var $layout=$el.closest(".layout");if(e.shiftKey){return this.removeLayout($layout)}$layout.addClass("-hover");var tooltip=acs.newTooltip({confirmRemove:true,target:$el,context:this,confirm:function(){this.removeLayout($layout)},cancel:function(){$layout.removeClass("-hover")}})},removeLayout:function($layout){var self=this;var endHeight=this.getValue()==1?60:0;acs.remove({target:$layout,endHeight:endHeight,complete:function(){self.$input().trigger("change");self.render()}})},onClickCollapse:function(e,$el){var $layout=$el.closest(".layout");if(this.isLayoutClosed($layout)){this.openLayout($layout)}else{this.closeLayout($layout)}},isLayoutClosed:function($layout){return $layout.hasClass("-collapsed")},openLayout:function($layout){$layout.removeClass("-collapsed");acs.doAction("show",$layout,"collapse")},closeLayout:function($layout){$layout.addClass("-collapsed");acs.doAction("hide",$layout,"collapse");this.renderLayout($layout)},renderLayout:function($layout){var $input=$layout.children("input");var prefix=$input.attr("name").replace("[acs_fc_layout]","");var ajaxData={action:"acs/fields/flexible_content/layout_title",field_key:this.get("key"),i:$layout.index(),layout:$layout.data("layout"),value:acs.serialize($layout,prefix)};$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),dataType:"html",type:"post",success:function(html){if(html){$layout.children(".acs-fc-layout-handle").html(html)}}})},onUnload:function(){var indexes=[];this.$layouts().each(function(i){if($(this).hasClass("-collapsed")){indexes.push(i)}});indexes=indexes.length?indexes:null;preference.save(this.get("key"),indexes)},onInvalidField:function(e,$layout){if(this.isLayoutClosed($layout)){this.openLayout($layout)}},onHover:function(){this.addSortable(this);this.off("mouseover")}});acs.registerFieldType(Field);var Popup=acs.models.TooltipConfirm.extend({events:{"click [data-layout]":"onConfirm",'click [data-event="cancel"]':"onCancel"},render:function(){this.html(this.get("text"));this.$el.addClass("acs-fc-popup")}});acs.registerConditionForFieldType("hasValue","flexible_content");acs.registerConditionForFieldType("hasNoValue","flexible_content");acs.registerConditionForFieldType("lessThan","flexible_content");acs.registerConditionForFieldType("greaterThan","flexible_content");var preference=new acs.Model({name:"this.collapsedLayouts",key:function(key,context){var count=this.get(key+context)||0;count++;this.set(key+context,count,true);if(count>1){key+="-"+count}return key},load:function(key){var key=this.key(key,"load");var data=acs.getPreference(this.name);if(data&&data[key]){return data[key]}else{return false}},save:function(key,value){var key=this.key(key,"save");var data=acs.getPreference(this.name)||{};if(value===null){delete data[key]}else{data[key]=value}if($.isEmptyObject(data)){data=null}acs.setPreference(this.name,data)}})})(jQuery);(function($){var Field=acs.Field.extend({type:"gallery",events:{"click .acs-gallery-add":"onClickAdd","click .acs-gallery-edit":"onClickEdit","click .acs-gallery-remove":"onClickRemove","click .acs-gallery-attachment":"onClickSelect","click .acs-gallery-close":"onClickClose","change .acs-gallery-sort":"onChangeSort","click .acs-gallery-update":"onUpdate",mouseover:"onHover",showField:"render"},actions:{validation_begin:"onValidationBegin",validation_failure:"onValidationFailure",resize:"onResize"},onValidationBegin:function(){acs.disable(this.$sideData(),this.cid)},onValidationFailure:function(){acs.enable(this.$sideData(),this.cid)},$control:function(){return this.$(".acs-gallery")},$collection:function(){return this.$(".acs-gallery-attachments")},$attachments:function(){return this.$(".acs-gallery-attachment")},$attachment:function(id){return this.$('.acs-gallery-attachment[data-id="'+id+'"]')},$active:function(){return this.$(".acs-gallery-attachment.active")},$main:function(){return this.$(".acs-gallery-main")},$side:function(){return this.$(".acs-gallery-side")},$sideData:function(){return this.$(".acs-gallery-side-data")},isFull:function(){var max=parseInt(this.get("max"));var count=this.$attachments().length;return max&&count>=max},getValue:function(){var val=[];this.$attachments().each(function(){val.push($(this).data("id"))});return val.length?val:false},addUnscopedEvents:function(self){this.on("change",".acs-gallery-side",function(e){self.onUpdate(e,$(this))})},addSortable:function(self){this.$collection().sortable({items:".acs-gallery-attachment",forceHelperSize:true,forcePlaceholderSize:true,scroll:true,start:function(event,ui){ui.placeholder.html(ui.item.html());ui.placeholder.removeAttr("style")},update:function(event,ui){self.$input().trigger("change")}});this.$control().resizable({handles:"s",minHeight:200,stop:function(event,ui){acs.update_user_setting("gallery_height",ui.size.height)}})},initialize:function(){this.addUnscopedEvents(this);this.render()},render:function(){var $sort=this.$(".acs-gallery-sort");var $add=this.$(".acs-gallery-add");var count=this.$attachments().length;if(this.isFull()){$add.addClass("disabled")}else{$add.removeClass("disabled")}if(!count){$sort.addClass("disabled")}else{$sort.removeClass("disabled")}this.resize()},resize:function(){var width=this.$control().width();var target=150;var columns=Math.round(width/target);columns=Math.min(columns,8);this.$control().attr("data-columns",columns)},onResize:function(){this.resize()},openSidebar:function(){this.$control().addClass("-open");var width=this.$control().width()/3;width=parseInt(width);width=Math.max(width,350);this.$(".acs-gallery-side-inner").css({width:width-1});this.$side().animate({width:width-1},250);this.$main().animate({right:width},250)},closeSidebar:function(){this.$control().removeClass("-open");this.$active().removeClass("active");acs.disable(this.$side());var $sideData=this.$(".acs-gallery-side-data");this.$main().animate({right:0},250);this.$side().animate({width:0},250,function(){$sideData.html("")})},onClickAdd:function(e,$el){if(this.isFull()){this.showNotice({text:acs.__("Maximum selection reached"),type:"warning"});return}var frame=acs.newMediaPopup({mode:"select",title:acs.__("Add Image to Gallery"),field:this.get("key"),multiple:"add",library:this.get("library"),allowedTypes:this.get("mime_types"),selected:this.val(),select:$.proxy(function(attachment,i){this.appendAttachment(attachment,i)},this)})},appendAttachment:function(attachment,i){attachment=this.validateAttachment(attachment);if(this.isFull()){return}if(this.$attachment(attachment.id).length){return}var html=['<div class="acs-gallery-attachment" data-id="'+attachment.id+'">','<input type="hidden" value="'+attachment.id+'" name="'+this.getInputName()+'[]">','<div class="margin" title="">','<div class="thumbnail">','<img src="" alt="">',"</div>",'<div class="filename"></div>',"</div>",'<div class="actions">','<a href="#" class="acs-icon -cancel dark acs-gallery-remove" data-id="'+attachment.id+'"></a>',"</div>","</div>"].join("");var $html=$(html);this.$collection().append($html);if(this.get("insert")==="prepend"){var $before=this.$attachments().eq(i);if($before.length){$before.before($html)}}this.renderAttachment(attachment);this.render();this.$input().trigger("change")},validateAttachment:function(attachment){attachment=acs.parseArgs(attachment,{id:"",url:"",alt:"",title:"",filename:"",type:"image"});if(attachment.attributes){attachment=attachment.attributes;var url=acs.isget(attachment,"sizes",this.get("preview_size"),"url");if(url!==null){attachment.url=url}}return attachment},renderAttachment:function(attachment){attachment=this.validateAttachment(attachment);var $el=this.$attachment(attachment.id);if(attachment.type=="image"){$el.find(".filename").remove()}else{var image=acs.isget(attachment,"image","src");if(image!==null){attachment.url=image}$el.find(".filename").text(attachment.filename)}if(!attachment.url){attachment.url=acs.get("mimeTypeIcon");$el.addClass("-icon")}$el.find("img").attr({src:attachment.url,alt:attachment.alt,title:attachment.title});acs.val($el.find("input"),attachment.id)},editAttachment:function(id){var frame=acs.newMediaPopup({mode:"edit",title:acs.__("Edit Image"),button:acs.__("Update Image"),attachment:id,field:this.get("key"),select:$.proxy(function(attachment,i){this.renderAttachment(attachment)},this)})},onClickEdit:function(e,$el){var id=$el.data("id");if(id){this.editAttachment(id)}},removeAttachment:function(id){this.closeSidebar();this.$attachment(id).remove();this.render();this.$input().trigger("change")},onClickRemove:function(e,$el){e.preventDefault();e.stopPropagation();var id=$el.data("id");if(id){this.removeAttachment(id)}},selectAttachment:function(id){var $el=this.$attachment(id);if($el.hasClass("active")){return}var step1=this.proxy(function(){this.$side().find(":focus").trigger("blur");this.$active().removeClass("active");$el.addClass("active");this.openSidebar();step2()});var step2=this.proxy(function(){var ajaxData={action:"acs/fields/gallery/get_attachment",field_key:this.get("key"),id:id};if(this.has("xhr")){this.get("xhr").abort()}acs.showLoading(this.$sideData());var xhr=$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"html",cache:false,success:step3});this.set("xhr",xhr)});var step3=this.proxy(function(html){if(!html){return}var $side=this.$sideData();$side.html(html);$side.find(".compat-field-acs-form-data").remove();$side.find("> table.form-table > tbody").append($side.find("> .compat-attachment-fields > tbody > tr"));acs.doAction("append",$side)});step1()},onClickSelect:function(e,$el){var id=$el.data("id");if(id){this.selectAttachment(id)}},onClickClose:function(e,$el){this.closeSidebar()},onChangeSort:function(e,$el){if($el.hasClass("disabled")){return}var val=$el.val();if(!val){return}var ids=[];this.$attachments().each(function(){ids.push($(this).data("id"))});var step1=this.proxy(function(){var ajaxData={action:"acs/fields/gallery/get_sort_order",field_key:this.get("key"),ids:ids,sort:val};var xhr=$.ajax({url:acs.get("ajaxurl"),dataType:"json",type:"post",cache:false,data:acs.prepareForAjax(ajaxData),success:step2})});var step2=this.proxy(function(json){if(!acs.isAjaxSuccess(json)){return}json.data.reverse();json.data.map(function(id){this.$collection().prepend(this.$attachment(id))},this)});step1()},onUpdate:function(e,$el){var $submit=this.$(".acs-gallery-update");if($submit.hasClass("disabled")){return}var ajaxData=acs.serialize(this.$sideData());$submit.addClass("disabled");$submit.before('<i class="acs-loading"></i> ');ajaxData.action="acs/fields/gallery/update_attachment";$.ajax({url:acs.get("ajaxurl"),data:acs.prepareForAjax(ajaxData),type:"post",dataType:"json",complete:function(){$submit.removeClass("disabled");$submit.prev(".acs-loading").remove()}})},onHover:function(){this.addSortable(this);this.off("mouseover")}});acs.registerFieldType(Field);acs.registerConditionForFieldType("hasValue","gallery");acs.registerConditionForFieldType("hasNoValue","gallery");acs.registerConditionForFieldType("selectionLessThan","gallery");acs.registerConditionForFieldType("selectionGreaterThan","gallery")})(jQuery);